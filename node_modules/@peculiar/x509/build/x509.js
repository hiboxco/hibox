/*!
 * MIT License
 * 
 * Copyright (c) Peculiar Ventures. All rights reserved.
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */
var x509=function(e){"use strict";var t,r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};
/*! *****************************************************************************
	Copyright (C) Microsoft. All rights reserved.
	Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	this file except in compliance with the License. You may obtain a copy of the
	License at http://www.apache.org/licenses/LICENSE-2.0

	THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	MERCHANTABLITY OR NON-INFRINGEMENT.

	See the Apache Version 2.0 License for specific language governing permissions
	and limitations under the License.
	***************************************************************************** */function n(e,t,r){return e instanceof Object==!1?r:t in e?e[t]:r}function i(e,t=0,r=e.byteLength-t,n=!1){let i="";for(const o of new Uint8Array(e,t,r)){const e=o.toString(16).toUpperCase();1===e.length&&(i+="0"),i+=e,n&&(i+=" ")}return i.trim()}function o(e,t,r,n){return t instanceof ArrayBuffer==!1?(e.error='Wrong parameter: inputBuffer must be "ArrayBuffer"',!1):0===t.byteLength?(e.error="Wrong parameter: inputBuffer has zero length",!1):r<0?(e.error="Wrong parameter: inputOffset less than zero",!1):n<0?(e.error="Wrong parameter: inputLength less than zero",!1):!(t.byteLength-r-n<0)||(e.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1)}function s(e,t){let r=0;if(1===e.length)return e[0];for(let n=e.length-1;n>=0;n--)r+=e[e.length-1-n]*Math.pow(2,t*n);return r}function a(e,t,r=-1){const n=r;let i=e,o=0,s=Math.pow(2,t);for(let r=1;r<8;r++){if(e<s){let e;if(n<0)e=new ArrayBuffer(r),o=r;else{if(n<r)return new ArrayBuffer(0);e=new ArrayBuffer(n),o=n}const s=new Uint8Array(e);for(let e=r-1;e>=0;e--){const r=Math.pow(2,e*t);s[o-e-1]=Math.floor(i/r),i-=s[o-e-1]*r}return e}s*=Math.pow(2,t)}return new ArrayBuffer(0)}function c(...e){let t=0,r=0;for(const r of e)t+=r.byteLength;const n=new ArrayBuffer(t),i=new Uint8Array(n);for(const t of e)i.set(new Uint8Array(t),r),r+=t.byteLength;return n}function l(...e){let t=0,r=0;for(const r of e)t+=r.length;const n=new ArrayBuffer(t),i=new Uint8Array(n);for(const t of e)i.set(t,r),r+=t.length;return i}function u(){const e=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const t=255===e[0]&&128&e[1],r=0===e[0]&&0==(128&e[1]);(t||r)&&this.warnings.push("Needlessly long format")}const t=new ArrayBuffer(this.valueHex.byteLength),r=new Uint8Array(t);for(let e=0;e<this.valueHex.byteLength;e++)r[e]=0;r[0]=128&e[0];const n=s(r,8),i=new ArrayBuffer(this.valueHex.byteLength),o=new Uint8Array(i);for(let t=0;t<this.valueHex.byteLength;t++)o[t]=e[t];o[0]&=127;return s(o,8)-n}function h(e,t){if(e.byteLength!==t.byteLength)return!1;const r=new Uint8Array(e),n=new Uint8Array(t);for(let e=0;e<r.length;e++)if(r[e]!==n[e])return!1;return!0}function p(e,t){const r=e.toString(10);if(t<r.length)return"";const n=t-r.length,i=new Array(n);for(let e=0;e<n;e++)i[e]="0";return i.join("").concat(r)}!function(e){!function(t){var n="object"==typeof r?r:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),i=o(e);function o(e,t){return function(r,n){"function"!=typeof e[r]&&Object.defineProperty(e,r,{configurable:!0,writable:!0,value:n}),t&&t(r,n)}}void 0===n.Reflect?n.Reflect=e:i=o(n.Reflect,i),function(e){var t=Object.prototype.hasOwnProperty,r="function"==typeof Symbol,n=r&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",i=r&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,s={__proto__:[]}instanceof Array,a=!o&&!s,c={create:o?function(){return ne(Object.create(null))}:s?function(){return ne({__proto__:null})}:function(){return ne({})},has:a?function(e,r){return t.call(e,r)}:function(e,t){return t in e},get:a?function(e,r){return t.call(e,r)?e[r]:void 0}:function(e,t){return e[t]}},l=Object.getPrototypeOf(Function),u="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,h=u||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?ee():Map,p=u||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?te():Set,f=new(u||"function"!=typeof WeakMap?re():WeakMap);function y(e,t,r,n){if(H(r)){if(!K(e))throw new TypeError;if(!q(t))throw new TypeError;return S(e,t)}if(!K(e))throw new TypeError;if(!D(t))throw new TypeError;if(!D(n)&&!H(n)&&!R(n))throw new TypeError;return R(n)&&(n=void 0),x(e,t,r=z(r),n)}function d(e,t){function r(r,n){if(!D(r))throw new TypeError;if(!H(n)&&!J(n))throw new TypeError;T(e,t,r,n)}return r}function g(e,t,r,n){if(!D(r))throw new TypeError;return H(n)||(n=z(n)),T(e,t,r,n)}function v(e,t,r){if(!D(t))throw new TypeError;return H(r)||(r=z(r)),C(e,t,r)}function m(e,t,r){if(!D(t))throw new TypeError;return H(r)||(r=z(r)),O(e,t,r)}function b(e,t,r){if(!D(t))throw new TypeError;return H(r)||(r=z(r)),N(e,t,r)}function w(e,t,r){if(!D(t))throw new TypeError;return H(r)||(r=z(r)),E(e,t,r)}function B(e,t){if(!D(e))throw new TypeError;return H(t)||(t=z(t)),U(e,t)}function k(e,t){if(!D(e))throw new TypeError;return H(t)||(t=z(t)),L(e,t)}function A(e,t,r){if(!D(t))throw new TypeError;H(r)||(r=z(r));var n=I(t,r,!1);if(H(n))return!1;if(!n.delete(e))return!1;if(n.size>0)return!0;var i=f.get(t);return i.delete(r),i.size>0||f.delete(t),!0}function S(e,t){for(var r=e.length-1;r>=0;--r){var n=(0,e[r])(t);if(!H(n)&&!R(n)){if(!q(n))throw new TypeError;t=n}}return t}function x(e,t,r,n){for(var i=e.length-1;i>=0;--i){var o=(0,e[i])(t,r,n);if(!H(o)&&!R(o)){if(!D(o))throw new TypeError;n=o}}return n}function I(e,t,r){var n=f.get(e);if(H(n)){if(!r)return;n=new h,f.set(e,n)}var i=n.get(t);if(H(i)){if(!r)return;i=new h,n.set(t,i)}return i}function C(e,t,r){if(O(e,t,r))return!0;var n=Q(t);return!R(n)&&C(e,n,r)}function O(e,t,r){var n=I(t,r,!1);return!H(n)&&F(n.has(e))}function N(e,t,r){if(O(e,t,r))return E(e,t,r);var n=Q(t);return R(n)?void 0:N(e,n,r)}function E(e,t,r){var n=I(t,r,!1);if(!H(n))return n.get(e)}function T(e,t,r,n){I(r,n,!0).set(e,t)}function U(e,t){var r=L(e,t),n=Q(e);if(null===n)return r;var i=U(n,t);if(i.length<=0)return r;if(r.length<=0)return i;for(var o=new p,s=[],a=0,c=r;a<c.length;a++){var l=c[a];o.has(l)||(o.add(l),s.push(l))}for(var u=0,h=i;u<h.length;u++){l=h[u];o.has(l)||(o.add(l),s.push(l))}return s}function L(e,t){var r=[],n=I(e,t,!1);if(H(n))return r;for(var i=W(n.keys()),o=0;;){var s=Y(i);if(!s)return r.length=o,r;var a=Z(s);try{r[o]=a}catch(e){try{X(i)}finally{throw e}}o++}}function j(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function H(e){return void 0===e}function R(e){return null===e}function P(e){return"symbol"==typeof e}function D(e){return"object"==typeof e?null!==e:"function"==typeof e}function _(e,t){switch(j(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var r=3===t?"string":5===t?"number":"default",i=G(e,n);if(void 0!==i){var o=i.call(e,r);if(D(o))throw new TypeError;return o}return $(e,"default"===r?"number":r)}function $(e,t){if("string"===t){var r=e.toString;if(M(r))if(!D(i=r.call(e)))return i;if(M(n=e.valueOf))if(!D(i=n.call(e)))return i}else{var n;if(M(n=e.valueOf))if(!D(i=n.call(e)))return i;var i,o=e.toString;if(M(o))if(!D(i=o.call(e)))return i}throw new TypeError}function F(e){return!!e}function V(e){return""+e}function z(e){var t=_(e,3);return P(t)?t:V(t)}function K(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function M(e){return"function"==typeof e}function q(e){return"function"==typeof e}function J(e){switch(j(e)){case 3:case 4:return!0;default:return!1}}function G(e,t){var r=e[t];if(null!=r){if(!M(r))throw new TypeError;return r}}function W(e){var t=G(e,i);if(!M(t))throw new TypeError;var r=t.call(e);if(!D(r))throw new TypeError;return r}function Z(e){return e.value}function Y(e){var t=e.next();return!t.done&&t}function X(e){var t=e.return;t&&t.call(e)}function Q(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===l)return t;if(t!==l)return t;var r=e.prototype,n=r&&Object.getPrototypeOf(r);if(null==n||n===Object.prototype)return t;var i=n.constructor;return"function"!=typeof i||i===e?t:i}function ee(){var e={},t=[],r=function(){function e(e,t,r){this._index=0,this._keys=e,this._values=t,this._selector=r}return e.prototype["@@iterator"]=function(){return this},e.prototype[i]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var r=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var r=this._find(e,!0);return this._values[r]=t,this},t.prototype.delete=function(t){var r=this._find(t,!1);if(r>=0){for(var n=this._keys.length,i=r+1;i<n;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new r(this._keys,this._values,n)},t.prototype.values=function(){return new r(this._keys,this._values,o)},t.prototype.entries=function(){return new r(this._keys,this._values,s)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[i]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function n(e,t){return e}function o(e,t){return t}function s(e,t){return[e,t]}}function te(){return function(){function e(){this._map=new h}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[i]=function(){return this.keys()},e}()}function re(){var e=16,r=c.create(),n=i();return function(){function e(){this._key=i()}return e.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&c.has(t,this._key)},e.prototype.get=function(e){var t=o(e,!1);return void 0!==t?c.get(t,this._key):void 0},e.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=i()},e}();function i(){var e;do{e="@@WeakMap@@"+l()}while(c.has(r,e));return r[e]=!0,e}function o(e,r){if(!t.call(e,n)){if(!r)return;Object.defineProperty(e,n,{value:c.create()})}return e[n]}function s(e,t){for(var r=0;r<t;++r)e[r]=255*Math.random()|0;return e}function a(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):s(new Uint8Array(e),e):s(new Array(e),e)}function l(){var t=a(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var r="",n=0;n<e;++n){var i=t[n];4!==n&&6!==n&&8!==n||(r+="-"),i<16&&(r+="0"),r+=i.toString(16).toLowerCase()}return r}}function ne(e){return e.__=void 0,delete e.__,e}e("decorate",y),e("metadata",d),e("defineMetadata",g),e("hasMetadata",v),e("hasOwnMetadata",m),e("getMetadata",b),e("getOwnMetadata",w),e("getMetadataKeys",B),e("getOwnMetadataKeys",k),e("deleteMetadata",A)}(i)}()}(t||(t={}));const f=[new Uint8Array([1])],y="0123456789";class d{constructor(e={}){this.blockLength=n(e,"blockLength",0),this.error=n(e,"error",""),this.warnings=n(e,"warnings",[]),this.valueBeforeDecode="valueBeforeDecode"in e?e.valueBeforeDecode.slice(0):new ArrayBuffer(0)}static blockName(){return"baseBlock"}toJSON(){return{blockName:this.constructor.blockName(),blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:i(this.valueBeforeDecode,0,this.valueBeforeDecode.byteLength)}}}const g=e=>class extends e{constructor(e={}){super(e),this.isHexOnly=n(e,"isHexOnly",!1),this.valueHex="valueHex"in e?e.valueHex.slice(0):new ArrayBuffer(0)}static blockName(){return"hexBlock"}fromBER(e,t,r){if(!1===o(this,e,t,r))return-1;return 0===new Uint8Array(e,t,r).length?(this.warnings.push("Zero buffer length"),t):(this.valueHex=e.slice(t,t+r),this.blockLength=r,t+r)}toBER(e=!1){return!0!==this.isHexOnly?(this.error='Flag "isHexOnly" is not set, abort',new ArrayBuffer(0)):!0===e?new ArrayBuffer(this.valueHex.byteLength):this.valueHex.slice(0)}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.blockName=this.constructor.blockName(),e.isHexOnly=this.isHexOnly,e.valueHex=i(this.valueHex,0,this.valueHex.byteLength),e}};class v extends(g(d)){constructor(e={}){super(),"idBlock"in e?(this.isHexOnly=n(e.idBlock,"isHexOnly",!1),this.valueHex=n(e.idBlock,"valueHex",new ArrayBuffer(0)),this.tagClass=n(e.idBlock,"tagClass",-1),this.tagNumber=n(e.idBlock,"tagNumber",-1),this.isConstructed=n(e.idBlock,"isConstructed",!1)):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}static blockName(){return"identificationBlock"}toBER(e=!1){let t,r,n=0;switch(this.tagClass){case 1:n|=0;break;case 2:n|=64;break;case 3:n|=128;break;case 4:n|=192;break;default:return this.error="Unknown tag class",new ArrayBuffer(0)}if(this.isConstructed&&(n|=32),this.tagNumber<31&&!this.isHexOnly){if(t=new ArrayBuffer(1),r=new Uint8Array(t),!e){let e=this.tagNumber;e&=31,n|=e,r[0]=n}return t}if(!1===this.isHexOnly){const i=a(this.tagNumber,7),o=new Uint8Array(i),s=i.byteLength;if(t=new ArrayBuffer(s+1),r=new Uint8Array(t),r[0]=31|n,!e){for(let e=0;e<s-1;e++)r[e+1]=128|o[e];r[s]=o[s-1]}return t}if(t=new ArrayBuffer(this.valueHex.byteLength+1),r=new Uint8Array(t),r[0]=31|n,!1===e){const e=new Uint8Array(this.valueHex);for(let t=0;t<e.length-1;t++)r[t+1]=128|e[t];r[this.valueHex.byteLength]=e[e.length-1]}return t}fromBER(e,t,r){if(!1===o(this,e,t,r))return-1;const n=new Uint8Array(e,t,r);if(0===n.length)return this.error="Zero buffer length",-1;switch(192&n[0]){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=32==(32&n[0]),this.isHexOnly=!1;const i=31&n[0];if(31!==i)this.tagNumber=i,this.blockLength=1;else{let e=1;this.valueHex=new ArrayBuffer(255);let t=255,r=new Uint8Array(this.valueHex);for(;128&n[e];){if(r[e-1]=127&n[e],e++,e>=n.length)return this.error="End of input reached before message was fully decoded",-1;if(e===t){t+=255;const e=new ArrayBuffer(t),n=new Uint8Array(e);for(let e=0;e<r.length;e++)n[e]=r[e];this.valueHex=new ArrayBuffer(t),r=new Uint8Array(this.valueHex)}}this.blockLength=e+1,r[e-1]=127&n[e];const i=new ArrayBuffer(e),o=new Uint8Array(i);for(let t=0;t<e;t++)o[t]=r[t];this.valueHex=new ArrayBuffer(e),r=new Uint8Array(this.valueHex),r.set(o),this.blockLength<=9?this.tagNumber=s(r,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.blockName=this.constructor.blockName(),e.tagClass=this.tagClass,e.tagNumber=this.tagNumber,e.isConstructed=this.isConstructed,e}}class m extends d{constructor(e={}){super(),"lenBlock"in e?(this.isIndefiniteForm=n(e.lenBlock,"isIndefiniteForm",!1),this.longFormUsed=n(e.lenBlock,"longFormUsed",!1),this.length=n(e.lenBlock,"length",0)):(this.isIndefiniteForm=!1,this.longFormUsed=!1,this.length=0)}static blockName(){return"lengthBlock"}fromBER(e,t,r){if(!1===o(this,e,t,r))return-1;const n=new Uint8Array(e,t,r);if(0===n.length)return this.error="Zero buffer length",-1;if(255===n[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===n[0],!0===this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(128&n[0]),!1===this.longFormUsed)return this.length=n[0],this.blockLength=1,t+this.blockLength;const i=127&n[0];if(i>8)return this.error="Too big integer",-1;if(i+1>n.length)return this.error="End of input reached before message was fully decoded",-1;const a=new Uint8Array(i);for(let e=0;e<i;e++)a[e]=n[e+1];return 0===a[i-1]&&this.warnings.push("Needlessly long encoded length"),this.length=s(a,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=i+1,t+this.blockLength}toBER(e=!1){let t,r;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),!1===e&&(r=new Uint8Array(t),r[0]=128),t;if(!0===this.longFormUsed){const n=a(this.length,8);if(n.byteLength>127)return this.error="Too big length",new ArrayBuffer(0);if(t=new ArrayBuffer(n.byteLength+1),!0===e)return t;const i=new Uint8Array(n);r=new Uint8Array(t),r[0]=128|n.byteLength;for(let e=0;e<n.byteLength;e++)r[e+1]=i[e];return t}return t=new ArrayBuffer(1),!1===e&&(r=new Uint8Array(t),r[0]=this.length),t}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.blockName=this.constructor.blockName(),e.isIndefiniteForm=this.isIndefiniteForm,e.longFormUsed=this.longFormUsed,e.length=this.length,e}}class b extends d{constructor(e={}){super(e)}static blockName(){return"valueBlock"}fromBER(e,t,r){throw TypeError('User need to make a specific function in a class which extends "ValueBlock"')}toBER(e=!1){throw TypeError('User need to make a specific function in a class which extends "ValueBlock"')}}class w extends d{constructor(e={},t=b){super(e),"name"in e&&(this.name=e.name),"optional"in e&&(this.optional=e.optional),"primitiveSchema"in e&&(this.primitiveSchema=e.primitiveSchema),this.idBlock=new v(e),this.lenBlock=new m(e),this.valueBlock=new t(e)}static blockName(){return"BaseBlock"}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}toBER(e=!1){let t;const r=this.idBlock.toBER(e),n=this.valueBlock.toBER(!0);this.lenBlock.length=n.byteLength;let i;if(t=c(r,this.lenBlock.toBER(e)),i=!1===e?this.valueBlock.toBER(e):new ArrayBuffer(this.lenBlock.length),t=c(t,i),!0===this.lenBlock.isIndefiniteForm){const r=new ArrayBuffer(2);if(!1===e){const e=new Uint8Array(r);e[0]=0,e[1]=0}t=c(t,r)}return t}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.idBlock=this.idBlock.toJSON(),e.lenBlock=this.lenBlock.toJSON(),e.valueBlock=this.valueBlock.toJSON(),"name"in this&&(e.name=this.name),"optional"in this&&(e.optional=this.optional),"primitiveSchema"in this&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(){return`${this.constructor.blockName()} : ${i(this.valueBlock.valueHex)}`}}class B extends b{constructor(e={}){super(e),this.valueHex="valueHex"in e?e.valueHex.slice(0):new ArrayBuffer(0),this.isHexOnly=n(e,"isHexOnly",!0)}fromBER(e,t,r){if(!1===o(this,e,t,r))return-1;const n=new Uint8Array(e,t,r);if(0===n.length)return this.warnings.push("Zero buffer length"),t;this.valueHex=new ArrayBuffer(n.length);const i=new Uint8Array(this.valueHex);for(let e=0;e<n.length;e++)i[e]=n[e];return this.blockLength=r,t+r}toBER(e=!1){return this.valueHex.slice(0)}static blockName(){return"PrimitiveValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.valueHex=i(this.valueHex,0,this.valueHex.byteLength),e.isHexOnly=this.isHexOnly,e}}class k extends w{constructor(e={}){super(e,B),this.idBlock.isConstructed=!1}static blockName(){return"PRIMITIVE"}}class A extends b{constructor(e={}){super(e),this.value=n(e,"value",[]),this.isIndefiniteForm=n(e,"isIndefiniteForm",!1)}fromBER(e,t,r){const n=t,i=r;if(!1===o(this,e,t,r))return-1;if(0===new Uint8Array(e,t,r).length)return this.warnings.push("Zero buffer length"),t;let s=t;for(;a=this.isIndefiniteForm,c=r,(!0===a?1:c)>0;){const t=me(e,s,r);if(-1===t.offset)return this.error=t.result.error,this.warnings.concat(t.result.warnings),-1;if(s=t.offset,this.blockLength+=t.result.blockLength,r-=t.result.blockLength,this.value.push(t.result),!0===this.isIndefiniteForm&&t.result.constructor.blockName()===I.blockName())break}var a,c;return!0===this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.blockName()===I.blockName()?this.value.pop():this.warnings.push("No EndOfContent block encoded")),this.valueBeforeDecode=e.slice(n,n+i),s}toBER(e=!1){let t=new ArrayBuffer(0);for(let r=0;r<this.value.length;r++){t=c(t,this.value[r].toBER(e))}return t}static blockName(){return"ConstructedValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}e.isIndefiniteForm=this.isIndefiniteForm,e.value=[];for(let t=0;t<this.value.length;t++)e.value.push(this.value[t].toJSON());return e}}class S extends w{constructor(e={}){super(e,A),this.idBlock.isConstructed=!0}static blockName(){return"CONSTRUCTED"}fromBER(e,t,r){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}toString(){const e=[];for(const t of this.valueBlock.value)e.push(t.toString().split("\n").map((e=>`  ${e}`)).join("\n"));const t=3===this.idBlock.tagClass?`[${this.idBlock.tagNumber}]`:this.constructor.blockName();return e.length?`${t} :\n${e.join("\n")}`:`${t} :`}}class x extends b{constructor(e={}){super(e)}fromBER(e,t,r){return t}toBER(e=!1){return new ArrayBuffer(0)}static blockName(){return"EndOfContentValueBlock"}}class I extends w{constructor(e={}){super(e,x),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}static blockName(){return"EndOfContent"}}class C extends b{constructor(e={}){if(super(e),this.value=n(e,"value",!1),this.isHexOnly=n(e,"isHexOnly",!1),"valueHex"in e)this.valueHex=e.valueHex.slice(0);else if(this.valueHex=new ArrayBuffer(1),!0===this.value){new Uint8Array(this.valueHex)[0]=255}}fromBER(e,t,r){if(!1===o(this,e,t,r))return-1;const n=new Uint8Array(e,t,r);r>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,this.valueHex=new ArrayBuffer(n.length);const i=new Uint8Array(this.valueHex);for(let e=0;e<n.length;e++)i[e]=n[e];return 0!==u.call(this)?this.value=!0:this.value=!1,this.blockLength=r,t+r}toBER(e=!1){return this.valueHex}static blockName(){return"BooleanValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.value=this.value,e.isHexOnly=this.isHexOnly,e.valueHex=i(this.valueHex,0,this.valueHex.byteLength),e}}class O extends w{constructor(e={}){super(e,C),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}static blockName(){return"BOOLEAN"}toString(){return`${this.constructor.blockName()} : ${this.valueBlock.value}`}}class N extends S{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}static blockName(){return"SEQUENCE"}}class E extends S{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}static blockName(){return"SET"}}class T extends w{constructor(e={}){super(e,d),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}static blockName(){return"NULL"}fromBER(e,t,r){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=r,t+r>e.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):t+r}toBER(e=!1){const t=new ArrayBuffer(2);if(!0===e)return t;const r=new Uint8Array(t);return r[0]=5,r[1]=0,t}toString(){return`${this.constructor.blockName()}`}}class U extends(g(A)){constructor(e={}){super(e),this.isConstructed=n(e,"isConstructed",!1)}fromBER(e,t,r){let n=0;if(!0===this.isConstructed){if(this.isHexOnly=!1,n=A.prototype.fromBER.call(this,e,t,r),-1===n)return n;for(let e=0;e<this.value.length;e++){const t=this.value[e].constructor.blockName();if(t===I.blockName()){if(!0===this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(t!==L.blockName())return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,n=super.fromBER(e,t,r),this.blockLength=r;return n}toBER(e=!1){if(!0===this.isConstructed)return A.prototype.toBER.call(this,e);let t=new ArrayBuffer(this.valueHex.byteLength);return!0===e||0===this.valueHex.byteLength||(t=this.valueHex.slice(0)),t}static blockName(){return"OctetStringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.isConstructed=this.isConstructed,e.isHexOnly=this.isHexOnly,e.valueHex=i(this.valueHex,0,this.valueHex.byteLength),e}}class L extends w{constructor(e={}){super(e,U),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,t,r){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===r)return 0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),t;if(!this.valueBlock.isConstructed){const n=e.slice(t,t+r);try{const e=be(n);-1!==e.offset&&e.offset===r&&(this.valueBlock.value=[e.result])}catch(e){}}return super.fromBER(e,t,r)}static blockName(){return"OCTET STRING"}isEqual(e){return e instanceof L!=!1&&JSON.stringify(this)===JSON.stringify(e)}toString(){return this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length?S.prototype.toString.call(this):`${this.constructor.blockName()} : ${i(this.valueBlock.valueHex)}`}}class j extends(g(A)){constructor(e={}){super(e),this.unusedBits=n(e,"unusedBits",0),this.isConstructed=n(e,"isConstructed",!1),this.blockLength=this.valueHex.byteLength}fromBER(e,t,r){if(0===r)return t;let n=-1;if(!0===this.isConstructed){if(n=A.prototype.fromBER.call(this,e,t,r),-1===n)return n;for(let e=0;e<this.value.length;e++){const t=this.value[e].constructor.blockName();if(t===I.blockName()){if(!0===this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(t!==H.blockName())return this.error="BIT STRING may consists of BIT STRINGs only",-1;if(this.unusedBits>0&&this.value[e].valueBlock.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;if(this.unusedBits=this.value[e].valueBlock.unusedBits,this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1}return n}if(!1===o(this,e,t,r))return-1;const i=new Uint8Array(e,t,r);if(this.unusedBits=i[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const n=e.slice(t+1,t+r);try{const e=be(n);-1!==e.offset&&e.offset===r-1&&(this.value=[e.result])}catch(e){}}this.valueHex=new ArrayBuffer(i.length-1);const s=new Uint8Array(this.valueHex);for(let e=0;e<r-1;e++)s[e]=i[e+1];return this.blockLength=i.length,t+r}toBER(e=!1){if(!0===this.isConstructed)return A.prototype.toBER.call(this,e);if(!0===e)return new ArrayBuffer(this.valueHex.byteLength+1);if(0===this.valueHex.byteLength)return new ArrayBuffer(0);const t=new Uint8Array(this.valueHex),r=new ArrayBuffer(this.valueHex.byteLength+1),n=new Uint8Array(r);n[0]=this.unusedBits;for(let e=0;e<this.valueHex.byteLength;e++)n[e+1]=t[e];return r}static blockName(){return"BitStringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.unusedBits=this.unusedBits,e.isConstructed=this.isConstructed,e.isHexOnly=this.isHexOnly,e.valueHex=i(this.valueHex,0,this.valueHex.byteLength),e}}class H extends w{constructor(e={}){super(e,j),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}static blockName(){return"BIT STRING"}fromBER(e,t,r){return 0===r?t:(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,t,r))}isEqual(e){return e instanceof H!=!1&&JSON.stringify(this)===JSON.stringify(e)}toString(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return S.prototype.toString.call(this);{const e=[],t=new Uint8Array(this.valueBlock.valueHex);for(const r of t)e.push(r.toString(2).padStart(8,"0"));return`${this.constructor.blockName()} : ${e.join("")}`}}}class R extends(g(b)){constructor(e={}){super(e),"value"in e&&(this.valueDec=e.value)}set valueHex(e){this._valueHex=e.slice(0),e.byteLength>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,e.byteLength>0&&(this._valueDec=u.call(this)))}get valueHex(){return this._valueHex}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this._valueHex=function(e){const t=e<0?-1*e:e;let r=128;for(let n=1;n<8;n++){if(t<=r){if(e<0){const e=a(r-t,8,n);return new Uint8Array(e)[0]|=128,e}let i=a(t,8,n),o=new Uint8Array(i);if(128&o[0]){const e=i.slice(0),t=new Uint8Array(e);i=new ArrayBuffer(i.byteLength+1),o=new Uint8Array(i);for(let r=0;r<e.byteLength;r++)o[r+1]=t[r];o[0]=0}return i}r*=Math.pow(2,8)}return new ArrayBuffer(0)}(e)}get valueDec(){return this._valueDec}fromDER(e,t,r,n=0){const i=this.fromBER(e,t,r);if(-1===i)return i;const o=new Uint8Array(this._valueHex);if(0===o[0]&&0!=(128&o[1])){const e=new ArrayBuffer(this._valueHex.byteLength-1);new Uint8Array(e).set(new Uint8Array(this._valueHex,1,this._valueHex.byteLength-1)),this._valueHex=e.slice(0)}else if(0!==n&&this._valueHex.byteLength<n){n-this._valueHex.byteLength>1&&(n=this._valueHex.byteLength+1);const e=new ArrayBuffer(n);new Uint8Array(e).set(o,n-this._valueHex.byteLength),this._valueHex=e.slice(0)}return i}toDER(e=!1){const t=new Uint8Array(this._valueHex);switch(!0){case 0!=(128&t[0]):{const e=new ArrayBuffer(this._valueHex.byteLength+1),r=new Uint8Array(e);r[0]=0,r.set(t,1),this._valueHex=e.slice(0)}break;case 0===t[0]&&0==(128&t[1]):{const e=new ArrayBuffer(this._valueHex.byteLength-1);new Uint8Array(e).set(new Uint8Array(this._valueHex,1,this._valueHex.byteLength-1)),this._valueHex=e.slice(0)}}return this.toBER(e)}fromBER(e,t,r){const n=super.fromBER(e,t,r);return-1===n?n:(this.blockLength=r,t+r)}toBER(e=!1){return this.valueHex.slice(0)}static blockName(){return"IntegerValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.valueDec=this.valueDec,e}toString(){function e(e,t){const r=new Uint8Array([0]);let n=new Uint8Array(e),i=new Uint8Array(t),o=n.slice(0);const s=o.length-1;let a=i.slice(0);const c=a.length-1;let u=0;let h=0;for(let e=c<s?s:c;e>=0;e--,h++){if(!0==h<a.length)u=o[s-h]+a[c-h]+r[0];else u=o[s-h]+r[0];if(r[0]=u/10,!0==h>=o.length)o=l(new Uint8Array([u%10]),o);else o[s-h]=u%10}return r[0]>0&&(o=l(r,o)),o.slice(0)}function t(e){if(e>=f.length)for(let t=f.length;t<=e;t++){const e=new Uint8Array([0]);let r=f[t-1].slice(0);for(let t=r.length-1;t>=0;t--){const n=new Uint8Array([(r[t]<<1)+e[0]]);e[0]=n[0]/10,r[t]=n[0]%10}e[0]>0&&(r=l(e,r)),f.push(r)}return f[e]}function r(e,t){let r=0,n=new Uint8Array(e),i=new Uint8Array(t),o=n.slice(0);const s=o.length-1;let a=i.slice(0);const c=a.length-1;let l,u=0;for(let e=c;e>=0;e--,u++)if(l=o[s-u]-a[c-u]-r,!0==l<0)r=1,o[s-u]=l+10;else r=0,o[s-u]=l;if(r>0)for(let e=s-c+1;e>=0;e--,u++){if(l=o[s-u]-r,!(l<0)){r=0,o[s-u]=l;break}r=1,o[s-u]=l+10}return o.slice()}const n=8*this._valueHex.byteLength-1;let i,o=new Uint8Array(8*this._valueHex.byteLength/3),s=0;const a=new Uint8Array(this._valueHex);let c="",u=!1;for(let l=this._valueHex.byteLength-1;l>=0;l--){i=a[l];for(let a=0;a<8;a++){if(1==(1&i))if(s===n)o=r(t(s),o),c="-";else o=e(o,t(s));s++,i>>=1}}for(let e=0;e<o.length;e++)o[e]&&(u=!0),u&&(c+=y.charAt(o[e]));return!1===u&&(c+=y.charAt(0)),c}}class P extends w{constructor(e={}){super(e,R),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}static blockName(){return"INTEGER"}isEqual(e){return e instanceof P?this.valueBlock.isHexOnly&&e.valueBlock.isHexOnly?h(this.valueBlock.valueHex,e.valueBlock.valueHex):this.valueBlock.isHexOnly===e.valueBlock.isHexOnly&&this.valueBlock.valueDec===e.valueBlock.valueDec:e instanceof ArrayBuffer&&h(this.valueBlock.valueHex,e)}convertToDER(){const e=new P({valueHex:this.valueBlock.valueHex});return e.valueBlock.toDER(),e}convertFromDER(){const e=this.valueBlock.valueHex.byteLength%2?this.valueBlock.valueHex.byteLength+1:this.valueBlock.valueHex.byteLength,t=new P({valueHex:this.valueBlock.valueHex});return t.valueBlock.fromDER(t.valueBlock.valueHex,0,t.valueBlock.valueHex.byteLength,e),t}toString(){const e=i(this.valueBlock.valueHex),t=BigInt(`0x${e}`);return`${this.constructor.blockName()} : ${t.toString()}`}}class D extends P{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}static blockName(){return"ENUMERATED"}}class _ extends(g(d)){constructor(e={}){super(e),this.valueDec=n(e,"valueDec",-1),this.isFirstSid=n(e,"isFirstSid",!1)}static blockName(){return"sidBlock"}fromBER(e,t,r){if(0===r)return t;if(!1===o(this,e,t,r))return-1;const n=new Uint8Array(e,t,r);this.valueHex=new ArrayBuffer(r);let i=new Uint8Array(this.valueHex);for(let e=0;e<r&&(i[e]=127&n[e],this.blockLength++,0!=(128&n[e]));e++);const a=new ArrayBuffer(this.blockLength),c=new Uint8Array(a);for(let e=0;e<this.blockLength;e++)c[e]=i[e];return this.valueHex=a.slice(0),i=new Uint8Array(this.valueHex),0!=(128&n[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===i[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=s(i,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e=!1){let t,r;if(this.isHexOnly){if(!0===e)return new ArrayBuffer(this.valueHex.byteLength);const n=new Uint8Array(this.valueHex);t=new ArrayBuffer(this.blockLength),r=new Uint8Array(t);for(let e=0;e<this.blockLength-1;e++)r[e]=128|n[e];return r[this.blockLength-1]=n[this.blockLength-1],t}const n=a(this.valueDec,7);if(0===n.byteLength)return this.error="Error during encoding SID value",new ArrayBuffer(0);if(t=new ArrayBuffer(n.byteLength),!1===e){const e=new Uint8Array(n);r=new Uint8Array(t);for(let t=0;t<n.byteLength-1;t++)r[t]=128|e[t];r[n.byteLength-1]=e[n.byteLength-1]}return t}toString(){let e="";if(!0===this.isHexOnly)e=i(this.valueHex,0,this.valueHex.byteLength);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.valueDec=this.valueDec,e.isFirstSid=this.isFirstSid,e}}class $ extends b{constructor(e={}){super(e),this.fromString(n(e,"value",""))}fromBER(e,t,r){let n=t;for(;r>0;){const t=new _;if(n=t.fromBER(e,n,r),-1===n)return this.blockLength=0,this.error=t.error,n;0===this.value.length&&(t.isFirstSid=!0),this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return n}toBER(e=!1){let t=new ArrayBuffer(0);for(let r=0;r<this.value.length;r++){const n=this.value[r].toBER(e);if(0===n.byteLength)return this.error=this.value[r].error,new ArrayBuffer(0);t=c(t,n)}return t}fromString(e){this.value=[];let t=0,r=0,n="",i=!1;do{if(r=e.indexOf(".",t),n=-1===r?e.substr(t):e.substr(t,r-t),t=r+1,i){const e=this.value[0];let t=0;switch(e.valueDec){case 0:break;case 1:t=40;break;case 2:t=80;break;default:return this.value=[],!1}const r=parseInt(n,10);if(isNaN(r))return!0;e.valueDec=r+t,i=!1}else{const e=new _;if(e.valueDec=parseInt(n,10),isNaN(e.valueDec))return!0;0===this.value.length&&(e.isFirstSid=!0,i=!0),this.value.push(e)}}while(-1!==r);return!0}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let n=this.value[r].toString();0!==r&&(e=`${e}.`),t?(n=`{${n}}`,this.value[r].isFirstSid?e=`2.{${n} - 80}`:e+=n):e+=n}return e}static blockName(){return"ObjectIdentifierValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}e.value=this.toString(),e.sidArray=[];for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}class F extends w{constructor(e={}){super(e,$),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}static blockName(){return"OBJECT IDENTIFIER"}toString(){return`${this.constructor.blockName()} : ${this.valueBlock.toString()}`}}class V extends(g(d)){constructor(e={}){super(e),this.isHexOnly=!0,this.value=""}static blockName(){return"Utf8StringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.value=this.value,e}}class z extends w{constructor(e={}){super(e,V),"value"in e&&this.fromString(e.value),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}static blockName(){return"UTF8String"}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,new Uint8Array(e));try{this.valueBlock.value=decodeURIComponent(escape(this.valueBlock.value))}catch(e){this.warnings.push(`Error during "decodeURIComponent": ${e}, using raw string`)}}fromString(e){const t=unescape(encodeURIComponent(e)),r=t.length;this.valueBlock.valueHex=new ArrayBuffer(r);const n=new Uint8Array(this.valueBlock.valueHex);for(let e=0;e<r;e++)n[e]=t.charCodeAt(e);this.valueBlock.value=e}toString(){return`${this.constructor.blockName()} : ${this.valueBlock.value}`}}class K extends(g(d)){constructor(e={}){super(e),this.valueDec=n(e,"valueDec",-1)}static blockName(){return"relativeSidBlock"}fromBER(e,t,r){if(0===r)return t;if(!1===o(this,e,t,r))return-1;const n=new Uint8Array(e,t,r);this.valueHex=new ArrayBuffer(r);let i=new Uint8Array(this.valueHex);for(let e=0;e<r&&(i[e]=127&n[e],this.blockLength++,0!=(128&n[e]));e++);const a=new ArrayBuffer(this.blockLength),c=new Uint8Array(a);for(let e=0;e<this.blockLength;e++)c[e]=i[e];return this.valueHex=a.slice(0),i=new Uint8Array(this.valueHex),0!=(128&n[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===i[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=s(i,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e=!1){let t,r;if(this.isHexOnly){if(!0===e)return new ArrayBuffer(this.valueHex.byteLength);const n=new Uint8Array(this.valueHex);t=new ArrayBuffer(this.blockLength),r=new Uint8Array(t);for(let e=0;e<this.blockLength-1;e++)r[e]=128|n[e];return r[this.blockLength-1]=n[this.blockLength-1],t}const n=a(this.valueDec,7);if(0===n.byteLength)return this.error="Error during encoding SID value",new ArrayBuffer(0);if(t=new ArrayBuffer(n.byteLength),!1===e){const e=new Uint8Array(n);r=new Uint8Array(t);for(let t=0;t<n.byteLength-1;t++)r[t]=128|e[t];r[n.byteLength-1]=e[n.byteLength-1]}return t}toString(){let e="";return e=!0===this.isHexOnly?i(this.valueHex,0,this.valueHex.byteLength):this.valueDec.toString(),e}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.valueDec=this.valueDec,e}}class M extends b{constructor(e={}){super(e),this.fromString(n(e,"value",""))}fromBER(e,t,r){let n=t;for(;r>0;){const t=new K;if(n=t.fromBER(e,n,r),-1===n)return this.blockLength=0,this.error=t.error,n;this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return n}toBER(e=!1){let t=new ArrayBuffer(0);for(let r=0;r<this.value.length;r++){const n=this.value[r].toBER(e);if(0===n.byteLength)return this.error=this.value[r].error,new ArrayBuffer(0);t=c(t,n)}return t}fromString(e){this.value=[];let t=0,r=0,n="";do{r=e.indexOf(".",t),n=-1===r?e.substr(t):e.substr(t,r-t),t=r+1;const i=new K;if(i.valueDec=parseInt(n,10),isNaN(i.valueDec))return!0;this.value.push(i)}while(-1!==r);return!0}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let n=this.value[r].toString();0!==r&&(e=`${e}.`),t?(n=`{${n}}`,e+=n):e+=n}return e}static blockName(){return"RelativeObjectIdentifierValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}e.value=this.toString(),e.sidArray=[];for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}class q extends w{constructor(e={}){super(e,M),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}static blockName(){return"RelativeObjectIdentifier"}}class J extends(g(d)){constructor(e={}){super(e),this.isHexOnly=!0,this.value=""}static blockName(){return"BmpStringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.value=this.value,e}}class G extends w{constructor(e={}){super(e,J),"value"in e&&this.fromString(e.value),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}static blockName(){return"BMPString"}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){const t=e.slice(0),r=new Uint8Array(t);for(let e=0;e<r.length;e+=2){const t=r[e];r[e]=r[e+1],r[e+1]=t}this.valueBlock.value=String.fromCharCode.apply(null,new Uint16Array(t))}fromString(e){const t=e.length;this.valueBlock.valueHex=new ArrayBuffer(2*t);const r=new Uint8Array(this.valueBlock.valueHex);for(let n=0;n<t;n++){const t=a(e.charCodeAt(n),8),i=new Uint8Array(t);if(i.length>2)continue;const o=2-i.length;for(let e=i.length-1;e>=0;e--)r[2*n+e+o]=i[e]}this.valueBlock.value=e}toString(){return`${this.constructor.blockName()} : ${this.valueBlock.value}`}}class W extends(g(d)){constructor(e={}){super(e),this.isHexOnly=!0,this.value=""}static blockName(){return"UniversalStringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.value=this.value,e}}class Z extends w{constructor(e={}){super(e,W),"value"in e&&this.fromString(e.value),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}static blockName(){return"UniversalString"}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){const t=e.slice(0),r=new Uint8Array(t);for(let e=0;e<r.length;e+=4)r[e]=r[e+3],r[e+1]=r[e+2],r[e+2]=0,r[e+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){const t=e.length;this.valueBlock.valueHex=new ArrayBuffer(4*t);const r=new Uint8Array(this.valueBlock.valueHex);for(let n=0;n<t;n++){const t=a(e.charCodeAt(n),8),i=new Uint8Array(t);if(i.length>4)continue;const o=4-i.length;for(let e=i.length-1;e>=0;e--)r[4*n+e+o]=i[e]}this.valueBlock.value=e}toString(){return`${this.constructor.blockName()} : ${this.valueBlock.value}`}}class Y extends(g(d)){constructor(e={}){super(e),this.value="",this.isHexOnly=!0}static blockName(){return"SimpleStringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.value=this.value,e}}class X extends w{constructor(e={}){super(e,Y),"value"in e&&this.fromString(e.value)}static blockName(){return"SIMPLESTRING"}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,new Uint8Array(e))}fromString(e){const t=e.length;this.valueBlock.valueHex=new ArrayBuffer(t);const r=new Uint8Array(this.valueBlock.valueHex);for(let n=0;n<t;n++)r[n]=e.charCodeAt(n);this.valueBlock.value=e}toString(){return`${this.constructor.blockName()} : ${this.valueBlock.value}`}}class Q extends X{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}static blockName(){return"NumericString"}}class ee extends X{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}static blockName(){return"PrintableString"}}class te extends X{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}static blockName(){return"TeletexString"}}class re extends X{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}static blockName(){return"VideotexString"}}class ne extends X{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}static blockName(){return"IA5String"}}class ie extends X{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}static blockName(){return"GraphicString"}}class oe extends X{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}static blockName(){return"VisibleString"}}class se extends X{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}static blockName(){return"GeneralString"}}class ae extends X{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}static blockName(){return"CharacterString"}}class ce extends oe{constructor(e={}){if(super(e),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,"value"in e){this.fromString(e.value),this.valueBlock.valueHex=new ArrayBuffer(e.value.length);const t=new Uint8Array(this.valueBlock.valueHex);for(let r=0;r<e.value.length;r++)t[r]=e.value.charCodeAt(r)}"valueDate"in e&&(this.fromDate(e.valueDate),this.valueBlock.valueHex=this.toBuffer()),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,new Uint8Array(e)))}toBuffer(){const e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){const t=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/gi.exec(e);if(null===t)return void(this.error="Wrong input string for convertion");const r=parseInt(t[1],10);this.year=r>=50?1900+r:2e3+r,this.month=parseInt(t[2],10),this.day=parseInt(t[3],10),this.hour=parseInt(t[4],10),this.minute=parseInt(t[5],10),this.second=parseInt(t[6],10)}toString(){const e=new Array(7);return e[0]=p(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=p(this.month,2),e[2]=p(this.day,2),e[3]=p(this.hour,2),e[4]=p(this.minute,2),e[5]=p(this.second,2),e[6]="Z",e.join("")}static blockName(){return"UTCTime"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.year=this.year,e.month=this.month,e.day=this.day,e.hour=this.hour,e.minute=this.minute,e.second=this.second,e}}class le extends oe{constructor(e={}){if(super(e),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,this.millisecond=0,"value"in e){this.fromString(e.value),this.valueBlock.valueHex=new ArrayBuffer(e.value.length);const t=new Uint8Array(this.valueBlock.valueHex);for(let r=0;r<e.value.length;r++)t[r]=e.value.charCodeAt(r)}"valueDate"in e&&(this.fromDate(e.valueDate),this.valueBlock.valueHex=this.toBuffer()),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,new Uint8Array(e)))}toBuffer(){const e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds(),this.millisecond=e.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(e){let t,r=!1,n="",i="",o=0,s=0,a=0;if("Z"===e[e.length-1])n=e.substr(0,e.length-1),r=!0;else{const t=new Number(e[e.length-1]);if(isNaN(t.valueOf()))throw new Error("Wrong input string for convertion");n=e}if(r){if(-1!==n.indexOf("+"))throw new Error("Wrong input string for convertion");if(-1!==n.indexOf("-"))throw new Error("Wrong input string for convertion")}else{let e=1,t=n.indexOf("+"),r="";if(-1===t&&(t=n.indexOf("-"),e=-1),-1!==t){if(r=n.substr(t+1),n=n.substr(0,t),2!==r.length&&4!==r.length)throw new Error("Wrong input string for convertion");let i=new Number(r.substr(0,2));if(isNaN(i.valueOf()))throw new Error("Wrong input string for convertion");if(s=e*i,4===r.length){if(i=new Number(r.substr(2,2)),isNaN(i.valueOf()))throw new Error("Wrong input string for convertion");a=e*i}}}let c=n.indexOf(".");if(-1===c&&(c=n.indexOf(",")),-1!==c){const e=new Number(`0${n.substr(c)}`);if(isNaN(e.valueOf()))throw new Error("Wrong input string for convertion");o=e.valueOf(),i=n.substr(0,c)}else i=n;switch(!0){case 8===i.length:if(t=/(\d{4})(\d{2})(\d{2})/gi,-1!==c)throw new Error("Wrong input string for convertion");break;case 10===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})/gi,-1!==c){let e=60*o;this.minute=Math.floor(e),e=60*(e-this.minute),this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 12===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==c){let e=60*o;this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 14===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==c){const e=1e3*o;this.millisecond=Math.floor(e)}break;default:throw new Error("Wrong input string for convertion")}const l=t.exec(i);if(null===l)throw new Error("Wrong input string for convertion");for(let e=1;e<l.length;e++)switch(e){case 1:this.year=parseInt(l[e],10);break;case 2:this.month=parseInt(l[e],10);break;case 3:this.day=parseInt(l[e],10);break;case 4:this.hour=parseInt(l[e],10)+s;break;case 5:this.minute=parseInt(l[e],10)+a;break;case 6:this.second=parseInt(l[e],10);break;default:throw new Error("Wrong input string for convertion")}if(!1===r){const e=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=e.getUTCFullYear(),this.month=e.getUTCMonth(),this.day=e.getUTCDay(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds(),this.millisecond=e.getUTCMilliseconds()}}toString(){const e=[];return e.push(p(this.year,4)),e.push(p(this.month,2)),e.push(p(this.day,2)),e.push(p(this.hour,2)),e.push(p(this.minute,2)),e.push(p(this.second,2)),0!==this.millisecond&&(e.push("."),e.push(p(this.millisecond,3))),e.push("Z"),e.join("")}static blockName(){return"GeneralizedTime"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.year=this.year,e.month=this.month,e.day=this.day,e.hour=this.hour,e.minute=this.minute,e.second=this.second,e.millisecond=this.millisecond,e}}class ue extends z{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}static blockName(){return"DATE"}}class he extends z{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}static blockName(){return"TimeOfDay"}}class pe extends z{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}static blockName(){return"DateTime"}}class fe extends z{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}static blockName(){return"Duration"}}class ye extends z{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}static blockName(){return"TIME"}}class de{constructor(e={}){this.value=n(e,"value",[]),this.optional=n(e,"optional",!1)}}class ge{constructor(e={}){this.name=n(e,"name",""),this.optional=n(e,"optional",!1)}}class ve{constructor(e={}){this.name=n(e,"name",""),this.optional=n(e,"optional",!1),this.value=n(e,"value",new ge),this.local=n(e,"local",!1)}}function me(e,t,r){const n=t;let i=new w({},Object);const s=new d;if(!1===o(s,e,t,r))return i.error=s.error,{offset:-1,result:i};if(0===new Uint8Array(e,t,r).length)return i.error="Zero buffer length",{offset:-1,result:i};let a=i.idBlock.fromBER(e,t,r);if(i.warnings.concat(i.idBlock.warnings),-1===a)return i.error=i.idBlock.error,{offset:-1,result:i};if(t=a,r-=i.idBlock.blockLength,a=i.lenBlock.fromBER(e,t,r),i.warnings.concat(i.lenBlock.warnings),-1===a)return i.error=i.lenBlock.error,{offset:-1,result:i};if(t=a,r-=i.lenBlock.blockLength,!1===i.idBlock.isConstructed&&!0===i.lenBlock.isIndefiniteForm)return i.error="Indefinite length form used for primitive encoding form",{offset:-1,result:i};let c=w;if(1===i.idBlock.tagClass){if(i.idBlock.tagNumber>=37&&!1===i.idBlock.isHexOnly)return i.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:i};switch(i.idBlock.tagNumber){case 0:if(!0===i.idBlock.isConstructed&&i.lenBlock.length>0)return i.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:i};c=I;break;case 1:c=O;break;case 2:c=P;break;case 3:c=H;break;case 4:c=L;break;case 5:c=T;break;case 6:c=F;break;case 10:c=D;break;case 12:c=z;break;case 13:c=q;break;case 14:c=ye;break;case 15:return i.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:i};case 16:c=N;break;case 17:c=E;break;case 18:c=Q;break;case 19:c=ee;break;case 20:c=te;break;case 21:c=re;break;case 22:c=ne;break;case 23:c=ce;break;case 24:c=le;break;case 25:c=ie;break;case 26:c=oe;break;case 27:c=se;break;case 28:c=Z;break;case 29:c=ae;break;case 30:c=G;break;case 31:c=ue;break;case 32:c=he;break;case 33:c=pe;break;case 34:c=fe;break;default:{let e;e=!0===i.idBlock.isConstructed?new S:new k,e.idBlock=i.idBlock,e.lenBlock=i.lenBlock,e.warnings=i.warnings,i=e}}}else c=!0===i.idBlock.isConstructed?S:k;return i=function(e,t){if(e instanceof t)return e;const r=new t;return r.idBlock=e.idBlock,r.lenBlock=e.lenBlock,r.warnings=e.warnings,r.valueBeforeDecode=e.valueBeforeDecode.slice(0),r}(i,c),a=i.fromBER(e,t,!0===i.lenBlock.isIndefiniteForm?r:i.lenBlock.length),i.valueBeforeDecode=e.slice(n,n+i.blockLength),{offset:a,result:i}}function be(e){if(0===e.byteLength){const e=new w({},Object);return e.error="Input buffer has zero length",{offset:-1,result:e}}return me(e,0,e.byteLength)}function we(e,t,r){if(r instanceof de){for(let n=0;n<r.value.length;n++){if(!0===we(e,t,r.value[n]).verified)return{verified:!0,result:e}}{const e={verified:!1,result:{error:"Wrong values for Choice type"}};return r.hasOwnProperty("name")&&(e.name=r.name),e}}if(r instanceof ge)return r.hasOwnProperty("name")&&(e[r.name]=t),{verified:!0,result:e};if(e instanceof Object==!1)return{verified:!1,result:{error:"Wrong root object"}};if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(r instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("idBlock"in r==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("fromBER"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("toBER"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const n=r.idBlock.toBER(!1);if(0===n.byteLength)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(-1===r.idBlock.fromBER(n,0,n.byteLength))return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(!1===r.idBlock.hasOwnProperty("tagClass"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagClass!==t.idBlock.tagClass)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("tagNumber"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagNumber!==t.idBlock.tagNumber)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("isConstructed"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isConstructed!==t.idBlock.isConstructed)return{verified:!1,result:e};if("isHexOnly"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isHexOnly!==t.idBlock.isHexOnly)return{verified:!1,result:e};if(!0===r.idBlock.isHexOnly){if("valueHex"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const n=new Uint8Array(r.idBlock.valueHex),i=new Uint8Array(t.idBlock.valueHex);if(n.length!==i.length)return{verified:!1,result:e};for(let t=0;t<n.length;t++)if(n[t]!==i[1])return{verified:!1,result:e}}if(r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(e[r.name]=t)),!0===r.idBlock.isConstructed){let n=0,i={verified:!1},o=r.valueBlock.value.length;if(o>0&&r.valueBlock.value[0]instanceof ve&&(o=t.valueBlock.value.length),0===o)return{verified:!0,result:e};if(0===t.valueBlock.value.length&&0!==r.valueBlock.value.length){let t=!0;for(let e=0;e<r.valueBlock.value.length;e++)t=t&&(r.valueBlock.value[e].optional||!1);return!0===t?{verified:!0,result:e}:(r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&delete e[r.name]),e.error="Inconsistent object length",{verified:!1,result:e})}for(let s=0;s<o;s++)if(s-n>=t.valueBlock.value.length){if(!1===r.valueBlock.value[s].optional){const t={verified:!1,result:e};return e.error="Inconsistent length between ASN.1 data and schema",r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(delete e[r.name],t.name=r.name)),t}}else if(r.valueBlock.value[0]instanceof ve){if(i=we(e,t.valueBlock.value[s],r.valueBlock.value[0].value),!1===i.verified){if(!0!==r.valueBlock.value[0].optional)return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&delete e[r.name]),i;n++}if("name"in r.valueBlock.value[0]&&r.valueBlock.value[0].name.length>0){let n={};n="local"in r.valueBlock.value[0]&&!0===r.valueBlock.value[0].local?t:e,void 0===n[r.valueBlock.value[0].name]&&(n[r.valueBlock.value[0].name]=[]),n[r.valueBlock.value[0].name].push(t.valueBlock.value[s])}}else if(i=we(e,t.valueBlock.value[s-n],r.valueBlock.value[s]),!1===i.verified){if(!0!==r.valueBlock.value[s].optional)return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&delete e[r.name]),i;n++}if(!1===i.verified){const t={verified:!1,result:e};return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(delete e[r.name],t.name=r.name)),t}return{verified:!0,result:e}}if("primitiveSchema"in r&&"valueHex"in t.valueBlock){const n=be(t.valueBlock.valueHex);if(-1===n.offset){const t={verified:!1,result:n.result};return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(delete e[r.name],t.name=r.name)),t}return we(e,n.result,r.primitiveSchema)}return{verified:!0,result:e}}var Be,ke,Ae=Object.freeze({__proto__:null,HexBlock:g,ValueBlock:b,BaseBlock:w,Primitive:k,Constructed:S,EndOfContent:I,Boolean:O,Sequence:N,Set:E,Null:T,OctetString:L,BitString:H,Integer:P,Enumerated:D,ObjectIdentifier:F,Utf8String:z,RelativeObjectIdentifier:q,BmpString:G,UniversalString:Z,NumericString:Q,PrintableString:ee,TeletexString:te,VideotexString:re,IA5String:ne,GraphicString:ie,VisibleString:oe,GeneralString:se,CharacterString:ae,UTCTime:ce,GeneralizedTime:le,DATE:ue,TimeOfDay:he,DateTime:pe,Duration:fe,TIME:ye,Choice:de,Any:ge,Repeated:ve,RawData:class{constructor(e={}){this.data=n(e,"data",new ArrayBuffer(0))}fromBER(e,t,r){return this.data=e.slice(t,r),t+r}toBER(e=!1){return this.data}},fromBER:be,compareSchema:we,verifySchema:function(e,t){if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};const r=be(e);return-1===r.offset?{verified:!1,result:r.result}:we(r.result,r.result,t)},fromJSON:function(e){}});!function(e){e[e.Sequence=0]="Sequence",e[e.Set=1]="Set",e[e.Choice=2]="Choice"}(Be||(Be={})),function(e){e[e.Any=1]="Any",e[e.Boolean=2]="Boolean",e[e.OctetString=3]="OctetString",e[e.BitString=4]="BitString",e[e.Integer=5]="Integer",e[e.Enumerated=6]="Enumerated",e[e.ObjectIdentifier=7]="ObjectIdentifier",e[e.Utf8String=8]="Utf8String",e[e.BmpString=9]="BmpString",e[e.UniversalString=10]="UniversalString",e[e.NumericString=11]="NumericString",e[e.PrintableString=12]="PrintableString",e[e.TeletexString=13]="TeletexString",e[e.VideotexString=14]="VideotexString",e[e.IA5String=15]="IA5String",e[e.GraphicString=16]="GraphicString",e[e.VisibleString=17]="VisibleString",e[e.GeneralString=18]="GeneralString",e[e.CharacterString=19]="CharacterString",e[e.UTCTime=20]="UTCTime",e[e.GeneralizedTime=21]="GeneralizedTime",e[e.DATE=22]="DATE",e[e.TimeOfDay=23]="TimeOfDay",e[e.DateTime=24]="DateTime",e[e.Duration=25]="Duration",e[e.TIME=26]="TIME",e[e.Null=27]="Null"}(ke||(ke={}));const Se={fromASN:e=>e instanceof T?null:e.valueBeforeDecode,toASN:e=>{if(null===e)return new T;const t=be(e);if(t.result.error)throw new Error(t.result.error);return t.result}},xe={fromASN:e=>e.valueBlock.valueHex.byteLength>4?e.valueBlock.toString():e.valueBlock.valueDec,toASN:e=>new P({value:e})},Ie={fromASN:e=>e.valueBlock.valueDec,toASN:e=>new D({value:e})},Ce={fromASN:e=>e.valueBlock.valueHex,toASN:e=>new P({valueHex:e})},Oe={fromASN:e=>e.valueBlock.valueHex,toASN:e=>new H({valueHex:e})},Ne={fromASN:e=>e.valueBlock.toString(),toASN:e=>new F({value:e})},Ee={fromASN:e=>e.valueBlock.value,toASN:e=>new O({value:e})},Te={fromASN:e=>e.valueBlock.valueHex,toASN:e=>new L({valueHex:e})};function Ue(e){return{fromASN:e=>e.valueBlock.value,toASN:t=>new e({value:t})}}const Le=Ue(z),je=Ue(G),He=Ue(Z),Re=Ue(Q),Pe=Ue(ee),De=Ue(te),_e=Ue(re),$e=Ue(ne),Fe=Ue(ie),Ve=Ue(oe),ze=Ue(se),Ke=Ue(ae),Me={fromASN:e=>e.toDate(),toASN:e=>new ce({valueDate:e})},qe={fromASN:e=>e.toDate(),toASN:e=>new le({valueDate:e})},Je={fromASN:e=>null,toASN:e=>new T};function Ge(e){switch(e){case ke.Any:return Se;case ke.BitString:return Oe;case ke.BmpString:return je;case ke.Boolean:return Ee;case ke.CharacterString:return Ke;case ke.Enumerated:return Ie;case ke.GeneralString:return ze;case ke.GeneralizedTime:return qe;case ke.GraphicString:return Fe;case ke.IA5String:return $e;case ke.Integer:return xe;case ke.Null:return Je;case ke.NumericString:return Re;case ke.ObjectIdentifier:return Ne;case ke.OctetString:return Te;case ke.PrintableString:return Pe;case ke.TeletexString:return De;case ke.UTCTime:return Me;case ke.UniversalString:return He;case ke.Utf8String:return Le;case ke.VideotexString:return _e;case ke.VisibleString:return Ve;default:return null}}class We{static isArrayBuffer(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)}static toArrayBuffer(e){const t=this.toUint8Array(e);return t.byteOffset||t.length?t.buffer.slice(t.byteOffset,t.byteOffset+t.length):t.buffer}static toUint8Array(e){return this.toView(e,Uint8Array)}static toView(e,t){if("undefined"!=typeof Buffer&&Buffer.isBuffer(e))return new t(e.buffer,e.byteOffset,e.byteLength);if(this.isArrayBuffer(e))return new t(e);if(this.isArrayBufferView(e))return new t(e.buffer,e.byteOffset,e.byteLength);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(e){return this.isArrayBufferView(e)||this.isArrayBuffer(e)}static isArrayBufferView(e){return ArrayBuffer.isView(e)||e&&this.isArrayBuffer(e.buffer)}static isEqual(e,t){const r=We.toUint8Array(e),n=We.toUint8Array(t);if(r.length!==n.byteLength)return!1;for(let e=0;e<r.length;e++)if(r[e]!==n[e])return!1;return!0}}class Ze{static fromString(e){const t=unescape(encodeURIComponent(e)),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r.buffer}static toString(e){const t=We.toUint8Array(e);let r="";for(let e=0;e<t.length;e++)r+=String.fromCharCode(t[e]);return decodeURIComponent(escape(r))}}class Ye{static toString(e,t=!1){const r=We.toArrayBuffer(e),n=new DataView(r);let i="";for(let e=0;e<r.byteLength;e+=2){const r=n.getUint16(e,t);i+=String.fromCharCode(r)}return i}static fromString(e,t=!1){const r=new ArrayBuffer(2*e.length),n=new DataView(r);for(let r=0;r<e.length;r++)n.setUint16(2*r,e.charCodeAt(r),t);return r}}class Xe{static isHex(e){return"string"==typeof e&&/^[a-z0-9]+$/i.test(e)}static isBase64(e){return"string"==typeof e&&/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}static isBase64Url(e){return"string"==typeof e&&/^[a-zA-Z0-9-_]+$/i.test(e)}static ToString(e,t="utf8"){const r=We.toUint8Array(e);switch(t.toLowerCase()){case"utf8":return this.ToUtf8String(r);case"binary":return this.ToBinary(r);case"hex":return this.ToHex(r);case"base64":return this.ToBase64(r);case"base64url":return this.ToBase64Url(r);case"utf16le":return Ye.toString(r,!0);case"utf16":case"utf16be":return Ye.toString(r);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromString(e,t="utf8"){if(!e)return new ArrayBuffer(0);switch(t.toLowerCase()){case"utf8":return this.FromUtf8String(e);case"binary":return this.FromBinary(e);case"hex":return this.FromHex(e);case"base64":return this.FromBase64(e);case"base64url":return this.FromBase64Url(e);case"utf16le":return Ye.fromString(e,!0);case"utf16":case"utf16be":return Ye.fromString(e);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToBase64(e){const t=We.toUint8Array(e);if("undefined"!=typeof btoa){const e=this.ToString(t,"binary");return btoa(e)}return Buffer.from(t).toString("base64")}static FromBase64(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!Xe.isBase64(t))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return"undefined"!=typeof atob?this.FromBinary(atob(t)):new Uint8Array(Buffer.from(t,"base64")).buffer}static FromBase64Url(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!Xe.isBase64Url(t))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(t.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(e){return this.ToBase64(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(e,t=Xe.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.FromBinary(e);case"utf8":return Ze.fromString(e);case"utf16":case"utf16be":return Ye.fromString(e);case"utf16le":case"usc2":return Ye.fromString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToUtf8String(e,t=Xe.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.ToBinary(e);case"utf8":return Ze.toString(e);case"utf16":case"utf16be":return Ye.toString(e);case"utf16le":case"usc2":return Ye.toString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromBinary(e){const t=e.length,r=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=e.charCodeAt(n);return r.buffer}static ToBinary(e){const t=We.toUint8Array(e);let r="";for(let e=0;e<t.length;e++)r+=String.fromCharCode(t[e]);return r}static ToHex(e){const t=We.toUint8Array(e),r=[],n=t.length;for(let e=0;e<n;e++){const n=t[e].toString(16).padStart(2,"0");r.push(n)}return r.join("")}static FromHex(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!Xe.isHex(t))throw new TypeError("Argument 'hexString' is not HEX encoded");t.length%2&&(t=`0${t}`);const r=new Uint8Array(t.length/2);for(let e=0;e<t.length;e+=2){const n=t.slice(e,e+2);r[e/2]=parseInt(n,16)}return r.buffer}static ToUtf16String(e,t=!1){return Ye.toString(e,t)}static FromUtf16String(e,t=!1){return Ye.fromString(e,t)}static Base64Padding(e){const t=4-e.length%4;if(t<4)for(let r=0;r<t;r++)e+="=";return e}static formatString(e){return(null==e?void 0:e.replace(/[\n\r\t ]/g,""))||""}}function Qe(e,t){if(!e||!t)return!1;if(e.byteLength!==t.byteLength)return!1;const r=new Uint8Array(e),n=new Uint8Array(t);for(let t=0;t<e.byteLength;t++)if(r[t]!==n[t])return!1;return!0}Xe.DEFAULT_UTF8_ENCODING="utf8";class et{constructor(e,t=0){if(this.unusedBits=0,this.value=new ArrayBuffer(0),e)if("number"==typeof e)this.fromNumber(e);else{if(!We.isBufferSource(e))throw TypeError("Unsupported type of 'params' argument for BitString");this.unusedBits=t,this.value=We.toArrayBuffer(e)}}fromASN(e){if(!(e instanceof H))throw new TypeError("Argument 'asn' is not instance of ASN.1 BitString");return this.unusedBits=e.valueBlock.unusedBits,this.value=e.valueBlock.valueHex,this}toASN(){return new H({unusedBits:this.unusedBits,valueHex:this.value})}toSchema(e){return new H({name:e})}toNumber(){let e="";const t=new Uint8Array(this.value);for(const r of t)e+=r.toString(2).padStart(8,"0");return e=e.split("").reverse().join(""),this.unusedBits&&(e=e.slice(this.unusedBits).padStart(this.unusedBits,"0")),parseInt(e,2)}fromNumber(e){let t=e.toString(2);const r=t.length+7>>3;this.unusedBits=(r<<3)-t.length;const n=new Uint8Array(r);t=t.padStart(r<<3,"0").split("").reverse().join("");let i=0;for(;i<r;)n[i]=parseInt(t.slice(i<<3,8+(i<<3)),2),i++;this.value=n.buffer}}class tt{constructor(e){"number"==typeof e?this.buffer=new ArrayBuffer(e):We.isBufferSource(e)?this.buffer=We.toArrayBuffer(e):Array.isArray(e)?this.buffer=new Uint8Array(e):this.buffer=new ArrayBuffer(0)}get byteLength(){return this.buffer.byteLength}get byteOffset(){return 0}fromASN(e){if(!(e instanceof L))throw new TypeError("Argument 'asn' is not instance of ASN.1 OctetString");return this.buffer=e.valueBlock.valueHex,this}toASN(){return new L({valueHex:this.buffer})}toSchema(e){return new L({name:e})}}function rt(e){return e&&e.prototype?!(!e.prototype.toASN||!e.prototype.fromASN)||rt(e.prototype):!!(e&&e.toASN&&e.fromASN)}function nt(e){var t;if(e){const r=Object.getPrototypeOf(e);return(null===(t=null==r?void 0:r.prototype)||void 0===t?void 0:t.constructor)===Array||nt(r)}return!1}function it(e,t){if(!e||!t)return!1;if(e.byteLength!==t.byteLength)return!1;const r=new Uint8Array(e),n=new Uint8Array(t);for(let t=0;t<e.byteLength;t++)if(r[t]!==n[t])return!1;return!0}const ot=new class{constructor(){this.items=new WeakMap}has(e){return this.items.has(e)}get(e){var t,r,n,i;const o=this.items.get(e);if(!o)throw new Error(`Cannot get schema for '${null!==(i=null===(n=null===(r=null===(t=e)||void 0===t?void 0:t.prototype)||void 0===r?void 0:r.constructor)||void 0===n?void 0:n.name)&&void 0!==i?i:e}' target`);return o}cache(e){const t=this.get(e);t.schema||(t.schema=this.create(e,!0))}createDefault(e){const t={type:Be.Sequence,items:{}},r=this.findParentSchema(e);return r&&(Object.assign(t,r),t.items=Object.assign({},t.items,r.items)),t}create(e,t){const r=this.items.get(e)||this.createDefault(e),n=[];for(const e in r.items){const i=r.items[e],o=t?e:"";let s;if("number"==typeof i.type){const e=ke[i.type],t=Ae[e];if(!t)throw new Error(`Cannot get ASN1 class by name '${e}'`);s=new t({name:o})}else if(rt(i.type)){s=(new i.type).toSchema(o)}else if(i.optional){this.get(i.type).type===Be.Choice?s=new ge({name:o}):(s=this.create(i.type,!1),s.name=o)}else s=new ge({name:o});const a=!!i.optional||void 0!==i.defaultValue;if(i.repeated){s.name="";s=new("set"===i.repeated?E:N)({name:"",value:[new ve({name:o,value:s})]})}if(null!==i.context&&void 0!==i.context)if(i.implicit)if("number"==typeof i.type||rt(i.type)){const e=i.repeated?S:k;n.push(new e({name:o,optional:a,idBlock:{tagClass:3,tagNumber:i.context}}))}else{this.cache(i.type);const e=!!i.repeated;let t=e?s:this.get(i.type).schema;t=t.valueBlock?t.valueBlock.value:t.value,n.push(new S({name:e?"":o,optional:a,idBlock:{tagClass:3,tagNumber:i.context},value:t}))}else n.push(new S({optional:a,idBlock:{tagClass:3,tagNumber:i.context},value:[s]}));else s.optional=a,n.push(s)}switch(r.type){case Be.Sequence:return new N({value:n,name:""});case Be.Set:return new E({value:n,name:""});case Be.Choice:return new de({value:n,name:""});default:throw new Error("Unsupported ASN1 type in use")}}set(e,t){return this.items.set(e,t),this}findParentSchema(e){const t=e.__proto__;if(t){return this.items.get(t)||this.findParentSchema(t)}return null}},st=e=>t=>{let r;ot.has(t)?r=ot.get(t):(r=ot.createDefault(t),ot.set(t,r)),Object.assign(r,e)},at=e=>(t,r)=>{let n;ot.has(t.constructor)?n=ot.get(t.constructor):(n=ot.createDefault(t.constructor),ot.set(t.constructor,n));const i=Object.assign({},e);if("number"==typeof i.type&&!i.converter){const n=Ge(e.type);if(!n)throw new Error(`Cannot get default converter for property '${r}' of ${t.constructor.name}`);i.converter=n}n.items[r]=i};class ct extends Error{constructor(){super(...arguments),this.schemas=[]}}class lt{static serialize(e){return e instanceof w?e.toBER(!1):this.toASN(e).toBER(!1)}static toASN(e){if(e&&rt(e.constructor))return e.toASN();const t=e.constructor,r=ot.get(t);ot.cache(t);let n,i=[];if(r.itemType)if("number"==typeof r.itemType){const n=Ge(r.itemType);if(!n)throw new Error(`Cannot get default converter for array item of ${t.name} ASN1 schema`);i=e.map((e=>n.toASN(e)))}else i=e.map((e=>this.toAsnItem({type:r.itemType},"[]",t,e)));else for(const n in r.items){const o=r.items[n],s=e[n];if(void 0===s||o.defaultValue===s||"object"==typeof o.defaultValue&&"object"==typeof s&&it(this.serialize(o.defaultValue),this.serialize(s)))continue;let a=lt.toAsnItem(o,n,t,s);if("number"==typeof o.context)if(o.implicit)if(o.repeated||"number"!=typeof o.type&&!rt(o.type))i.push(new S({optional:o.optional,idBlock:{tagClass:3,tagNumber:o.context},value:a.valueBlock.value}));else{const e={};e.valueHex=a instanceof T?a.valueBeforeDecode:a.valueBlock.toBER(),i.push(new k(Object.assign({optional:o.optional,idBlock:{tagClass:3,tagNumber:o.context}},e)))}else i.push(new S({optional:o.optional,idBlock:{tagClass:3,tagNumber:o.context},value:[a]}));else o.repeated?i=i.concat(a):i.push(a)}switch(r.type){case Be.Sequence:n=new N({value:i});break;case Be.Set:n=new E({value:i});break;case Be.Choice:if(!i[0])throw new Error(`Schema '${t.name}' has wrong data. Choice cannot be empty.`);n=i[0]}return n}static toAsnItem(e,t,r,n){let i;if("number"==typeof e.type){const o=e.converter;if(!o)throw new Error(`Property '${t}' doesn't have converter for type ${ke[e.type]} in schema '${r.name}'`);if(e.repeated){const t=Array.from(n,(e=>o.toASN(e)));i=new("sequence"===e.repeated?N:E)({value:t})}else i=o.toASN(n)}else if(e.repeated){const t=Array.from(n,(e=>this.toASN(e)));i=new("sequence"===e.repeated?N:E)({value:t})}else i=this.toASN(n);return i}}class ut extends Array{constructor(e=[]){if("number"==typeof e)super(e);else{super();for(const t of e)this.push(t)}}}class ht{static serialize(e){return lt.serialize(e)}static parse(e,t){return class{static parse(e,t){let r;if(e instanceof ArrayBuffer)r=e;else if("undefined"!=typeof Buffer&&Buffer.isBuffer(e))r=new Uint8Array(e).buffer;else{if(!(ArrayBuffer.isView(e)||e.buffer instanceof ArrayBuffer))throw new TypeError("Wrong type of 'data' argument");r=e.buffer}const n=be(r);if(n.result.error)throw new Error(n.result.error);return this.fromASN(n.result,t)}static fromASN(e,t){var r;try{if(rt(t))return(new t).fromASN(e);const n=ot.get(t);ot.cache(t);let i=n.schema;if(e.constructor===S&&n.type!==Be.Choice){i=new S({idBlock:{tagClass:3,tagNumber:e.idBlock.tagNumber},value:n.schema.valueBlock.value});for(const t in n.items)delete e[t]}const o=we(e,e,i);if(!o.verified)throw new ct(`Data does not match to ${t.name} ASN1 schema. ${o.result.error}`);const s=new t;if(nt(t)){if("number"==typeof n.itemType){const r=Ge(n.itemType);if(!r)throw new Error(`Cannot get default converter for array item of ${t.name} ASN1 schema`);return t.from(e.valueBlock.value,(e=>r.fromASN(e)))}return t.from(e.valueBlock.value,(e=>this.fromASN(e,n.itemType)))}for(const t in n.items){if(!e[t])continue;const i=n.items[t];if("number"==typeof i.type||rt(i.type)){const n=null!==(r=i.converter)&&void 0!==r?r:rt(i.type)?new i.type:null;if(!n)throw new Error("Converter is empty");if(i.repeated)if(i.implicit){const r=new("sequence"===i.repeated?N:E);r.valueBlock=e[t].valueBlock;const o=be(r.toBER(!1)).result.valueBlock.value;s[t]=Array.from(o,(e=>n.fromASN(e)))}else s[t]=Array.from(e[t],(e=>n.fromASN(e)));else{let r=e[t];if(i.implicit){let e;if(rt(i.type))e=(new i.type).toSchema("");else{const t=ke[i.type],r=Ae[t];if(!r)throw new Error(`Cannot get '${t}' class from asn1js module`);e=new r}e.valueBlock=r.valueBlock,r=be(e.toBER(!1)).result}s[t]=n.fromASN(r)}}else i.repeated?s[t]=Array.from(e[t],(e=>this.fromASN(e,i.type))):s[t]=this.fromASN(e[t],i.type)}return s}catch(e){throw e instanceof ct&&e.schemas.push(t.name),e}}}.parse(e,t)}static toString(e){const t=be(We.isBufferSource(e)?We.toArrayBuffer(e):ht.serialize(e));if(-1===t.offset)throw new Error(`Cannot decode ASN.1 data. ${t.result.error}`);return t.result.toString()}}
/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */function pt(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s}var ft,yt,dt,gt,vt={exports:{}};ft=vt,function(e){const t="(0?\\d+|0x[a-f0-9]+)",r={fourOctet:new RegExp(`^${t}\\.${t}\\.${t}\\.${t}$`,"i"),threeOctet:new RegExp(`^${t}\\.${t}\\.${t}$`,"i"),twoOctet:new RegExp(`^${t}\\.${t}$`,"i"),longValue:new RegExp(`^${t}$`,"i")},n=new RegExp("^0[0-7]+$","i"),i=new RegExp("^0x[a-f0-9]+$","i"),o="%[0-9a-z]{1,}",s="(?:[0-9a-f]+::?)+",a={zoneIndex:new RegExp(o,"i"),native:new RegExp(`^(::)?(${s})?([0-9a-f]+)?(::)?(${o})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${t}\\.${t}\\.${t}\\.${t}(${o})?)$`,"i"),transitional:new RegExp(`^((?:${s})|(?:::)(?:${s})?)${t}\\.${t}\\.${t}\\.${t}(${o})?$`,"i")};function c(e,t){if(e.indexOf("::")!==e.lastIndexOf("::"))return null;let r,n,i=0,o=-1,s=(e.match(a.zoneIndex)||[])[0];for(s&&(s=s.substring(1),e=e.replace(/%.+$/,""));(o=e.indexOf(":",o+1))>=0;)i++;if("::"===e.substr(0,2)&&i--,"::"===e.substr(-2,2)&&i--,i>t)return null;for(n=t-i,r=":";n--;)r+="0:";return":"===(e=e.replace("::",r))[0]&&(e=e.slice(1)),":"===e[e.length-1]&&(e=e.slice(0,-1)),{parts:t=function(){const t=e.split(":"),r=[];for(let e=0;e<t.length;e++)r.push(parseInt(t[e],16));return r}(),zoneId:s}}function l(e,t,r,n){if(e.length!==t.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let i,o=0;for(;n>0;){if(i=r-n,i<0&&(i=0),e[o]>>i!=t[o]>>i)return!1;n-=r,o+=1}return!0}function u(e){if(i.test(e))return parseInt(e,16);if("0"===e[0]&&!isNaN(parseInt(e[1],10))){if(n.test(e))return parseInt(e,8);throw new Error(`ipaddr: cannot parse ${e} as octal`)}return parseInt(e,10)}function h(e,t){for(;e.length<t;)e=`0${e}`;return e}const p={};p.IPv4=function(){function e(e){if(4!==e.length)throw new Error("ipaddr: ipv4 octet count should be 4");let t,r;for(t=0;t<e.length;t++)if(r=e[t],!(0<=r&&r<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=e}return e.prototype.SpecialRanges={unspecified:[[new e([0,0,0,0]),8]],broadcast:[[new e([255,255,255,255]),32]],multicast:[[new e([224,0,0,0]),4]],linkLocal:[[new e([169,254,0,0]),16]],loopback:[[new e([127,0,0,0]),8]],carrierGradeNat:[[new e([100,64,0,0]),10]],private:[[new e([10,0,0,0]),8],[new e([172,16,0,0]),12],[new e([192,168,0,0]),16]],reserved:[[new e([192,0,0,0]),24],[new e([192,0,2,0]),24],[new e([192,88,99,0]),24],[new e([198,51,100,0]),24],[new e([203,0,113,0]),24],[new e([240,0,0,0]),4]]},e.prototype.kind=function(){return"ipv4"},e.prototype.match=function(e,t){let r;if(void 0===t&&(r=e,e=r[0],t=r[1]),"ipv4"!==e.kind())throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return l(this.octets,e.octets,8,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const r={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};let n,i,o;for(n=3;n>=0;n-=1){if(i=this.octets[n],!(i in r))return null;if(o=r[i],t&&0!==o)return null;8!==o&&(t=!0),e+=o}return 32-e},e.prototype.range=function(){return p.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){return this.octets.slice(0)},e.prototype.toIPv4MappedAddress=function(){return p.IPv6.parse(`::ffff:${this.toString()}`)},e.prototype.toNormalizedString=function(){return this.toString()},e.prototype.toString=function(){return this.octets.join(".")},e}(),p.IPv4.broadcastAddressFromCIDR=function(e){try{const t=this.parseCIDR(e),r=t[0].toByteArray(),n=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[];let o=0;for(;o<4;)i.push(parseInt(r[o],10)|255^parseInt(n[o],10)),o++;return new this(i)}catch(e){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},p.IPv4.isIPv4=function(e){return null!==this.parser(e)},p.IPv4.isValid=function(e){try{return new this(this.parser(e)),!0}catch(e){return!1}},p.IPv4.isValidFourPartDecimal=function(e){return!(!p.IPv4.isValid(e)||!e.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},p.IPv4.networkAddressFromCIDR=function(e){let t,r,n,i,o;try{for(t=this.parseCIDR(e),n=t[0].toByteArray(),o=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[],r=0;r<4;)i.push(parseInt(n[r],10)&parseInt(o[r],10)),r++;return new this(i)}catch(e){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},p.IPv4.parse=function(e){const t=this.parser(e);if(null===t)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(t)},p.IPv4.parseCIDR=function(e){let t;if(t=e.match(/^(.+)\/(\d+)$/)){const e=parseInt(t[2]);if(e>=0&&e<=32){const r=[this.parse(t[1]),e];return Object.defineProperty(r,"toString",{value:function(){return this.join("/")}}),r}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},p.IPv4.parser=function(e){let t,n,i;if(t=e.match(r.fourOctet))return function(){const e=t.slice(1,6),r=[];for(let t=0;t<e.length;t++)n=e[t],r.push(u(n));return r}();if(t=e.match(r.longValue)){if(i=u(t[1]),i>4294967295||i<0)throw new Error("ipaddr: address outside defined range");return function(){const e=[];let t;for(t=0;t<=24;t+=8)e.push(i>>t&255);return e}().reverse()}return(t=e.match(r.twoOctet))?function(){const e=t.slice(1,4),r=[];if(i=u(e[1]),i>16777215||i<0)throw new Error("ipaddr: address outside defined range");return r.push(u(e[0])),r.push(i>>16&255),r.push(i>>8&255),r.push(255&i),r}():(t=e.match(r.threeOctet))?function(){const e=t.slice(1,5),r=[];if(i=u(e[2]),i>65535||i<0)throw new Error("ipaddr: address outside defined range");return r.push(u(e[0])),r.push(u(e[1])),r.push(i>>8&255),r.push(255&i),r}():null},p.IPv4.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>32)throw new Error("ipaddr: invalid IPv4 prefix length");const t=[0,0,0,0];let r=0;const n=Math.floor(e/8);for(;r<n;)t[r]=255,r++;return n<4&&(t[n]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},p.IPv6=function(){function e(e,t){let r,n;if(16===e.length)for(this.parts=[],r=0;r<=14;r+=2)this.parts.push(e[r]<<8|e[r+1]);else{if(8!==e.length)throw new Error("ipaddr: ipv6 part count should be 8 or 16");this.parts=e}for(r=0;r<this.parts.length;r++)if(n=this.parts[r],!(0<=n&&n<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");t&&(this.zoneId=t)}return e.prototype.SpecialRanges={unspecified:[new e([0,0,0,0,0,0,0,0]),128],linkLocal:[new e([65152,0,0,0,0,0,0,0]),10],multicast:[new e([65280,0,0,0,0,0,0,0]),8],loopback:[new e([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new e([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new e([0,0,0,0,0,65535,0,0]),96],rfc6145:[new e([0,0,0,0,65535,0,0,0]),96],rfc6052:[new e([100,65435,0,0,0,0,0,0]),96],"6to4":[new e([8194,0,0,0,0,0,0,0]),16],teredo:[new e([8193,0,0,0,0,0,0,0]),32],reserved:[[new e([8193,3512,0,0,0,0,0,0]),32]]},e.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()},e.prototype.kind=function(){return"ipv6"},e.prototype.match=function(e,t){let r;if(void 0===t&&(r=e,e=r[0],t=r[1]),"ipv6"!==e.kind())throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return l(this.parts,e.parts,16,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const r={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};let n,i;for(let o=7;o>=0;o-=1){if(n=this.parts[o],!(n in r))return null;if(i=r[n],t&&0!==i)return null;16!==i&&(t=!0),e+=i}return 128-e},e.prototype.range=function(){return p.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){let e;const t=[],r=this.parts;for(let n=0;n<r.length;n++)e=r[n],t.push(e>>8),t.push(255&e);return t},e.prototype.toFixedLengthString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(h(this.parts[t].toString(16),4));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");const e=this.parts.slice(-2),t=e[0],r=e[1];return new p.IPv4([t>>8,255&t,r>>8,255&r])},e.prototype.toNormalizedString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(this.parts[t].toString(16));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toRFC5952String=function(){const e=/((^|:)(0(:|$)){2,})/g,t=this.toNormalizedString();let r,n=0,i=-1;for(;r=e.exec(t);)r[0].length>i&&(n=r.index,i=r[0].length);return i<0?t:`${t.substring(0,n)}::${t.substring(n+i)}`},e.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},e}(),p.IPv6.broadcastAddressFromCIDR=function(e){try{const t=this.parseCIDR(e),r=t[0].toByteArray(),n=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[];let o=0;for(;o<16;)i.push(parseInt(r[o],10)|255^parseInt(n[o],10)),o++;return new this(i)}catch(e){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${e})`)}},p.IPv6.isIPv6=function(e){return null!==this.parser(e)},p.IPv6.isValid=function(e){if("string"==typeof e&&-1===e.indexOf(":"))return!1;try{const t=this.parser(e);return new this(t.parts,t.zoneId),!0}catch(e){return!1}},p.IPv6.networkAddressFromCIDR=function(e){let t,r,n,i,o;try{for(t=this.parseCIDR(e),n=t[0].toByteArray(),o=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[],r=0;r<16;)i.push(parseInt(n[r],10)&parseInt(o[r],10)),r++;return new this(i)}catch(e){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${e})`)}},p.IPv6.parse=function(e){const t=this.parser(e);if(null===t.parts)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(t.parts,t.zoneId)},p.IPv6.parseCIDR=function(e){let t,r,n;if((r=e.match(/^(.+)\/(\d+)$/))&&(t=parseInt(r[2]),t>=0&&t<=128))return n=[this.parse(r[1]),t],Object.defineProperty(n,"toString",{value:function(){return this.join("/")}}),n;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},p.IPv6.parser=function(e){let t,r,n,i,o,s;if(n=e.match(a.deprecatedTransitional))return this.parser(`::ffff:${n[1]}`);if(a.native.test(e))return c(e,8);if((n=e.match(a.transitional))&&(s=n[6]||"",t=c(n[1].slice(0,-1)+s,6),t.parts)){for(o=[parseInt(n[2]),parseInt(n[3]),parseInt(n[4]),parseInt(n[5])],r=0;r<o.length;r++)if(i=o[r],!(0<=i&&i<=255))return null;return t.parts.push(o[0]<<8|o[1]),t.parts.push(o[2]<<8|o[3]),{parts:t.parts,zoneId:t.zoneId}}return null},p.IPv6.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>128)throw new Error("ipaddr: invalid IPv6 prefix length");const t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];let r=0;const n=Math.floor(e/8);for(;r<n;)t[r]=255,r++;return n<16&&(t[n]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},p.fromByteArray=function(e){const t=e.length;if(4===t)return new p.IPv4(e);if(16===t)return new p.IPv6(e);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},p.isValid=function(e){return p.IPv6.isValid(e)||p.IPv4.isValid(e)},p.parse=function(e){if(p.IPv6.isValid(e))return p.IPv6.parse(e);if(p.IPv4.isValid(e))return p.IPv4.parse(e);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},p.parseCIDR=function(e){try{return p.IPv6.parseCIDR(e)}catch(t){try{return p.IPv4.parseCIDR(e)}catch(e){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},p.process=function(e){const t=this.parse(e);return"ipv6"===t.kind()&&t.isIPv4MappedAddress()?t.toIPv4Address():t},p.subnetMatch=function(e,t,r){let n,i,o,s;for(i in null==r&&(r="unicast"),t)if(Object.prototype.hasOwnProperty.call(t,i))for(o=t[i],!o[0]||o[0]instanceof Array||(o=[o]),n=0;n<o.length;n++)if(s=o[n],e.kind()===s[0].kind()&&e.match.apply(e,s))return i;return r},ft.exports?ft.exports=p:e.ipaddr=p}(r);class mt{static decodeIP(e){if(64===e.length&&0===parseInt(e,16))return"::/0";if(16!==e.length)return e;const t=parseInt(e.slice(8),16).toString(2).split("").reduce(((e,t)=>e+ +t),0);let r=e.slice(0,8).replace(/(.{2})/g,(e=>`${parseInt(e,16)}.`));return r=r.slice(0,-1),`${r}/${t}`}static toString(e){if(4===e.byteLength||16===e.byteLength){const t=new Uint8Array(e);return vt.exports.fromByteArray(Array.from(t)).toString()}return this.decodeIP(Xe.ToHex(e))}static fromString(e){const t=vt.exports.parse(e);return new Uint8Array(t.toByteArray()).buffer}}let bt=class{constructor(e={}){Object.assign(this,e)}toString(){return this.bmpString||this.printableString||this.teletexString||this.universalString||this.utf8String||""}};pt([at({type:ke.TeletexString})],bt.prototype,"teletexString",void 0),pt([at({type:ke.PrintableString})],bt.prototype,"printableString",void 0),pt([at({type:ke.UniversalString})],bt.prototype,"universalString",void 0),pt([at({type:ke.Utf8String})],bt.prototype,"utf8String",void 0),pt([at({type:ke.BmpString})],bt.prototype,"bmpString",void 0),bt=pt([st({type:Be.Choice})],bt);let wt=class extends bt{constructor(e={}){super(e),Object.assign(this,e)}toString(){return this.ia5String||(this.anyValue?Xe.ToHex(this.anyValue):super.toString())}};pt([at({type:ke.IA5String})],wt.prototype,"ia5String",void 0),pt([at({type:ke.Any})],wt.prototype,"anyValue",void 0),wt=pt([st({type:Be.Choice})],wt);class Bt{constructor(e={}){this.type="",this.value=new wt,Object.assign(this,e)}}pt([at({type:ke.ObjectIdentifier})],Bt.prototype,"type",void 0),pt([at({type:wt})],Bt.prototype,"value",void 0);let kt=yt=class extends ut{constructor(e){super(e),Object.setPrototypeOf(this,yt.prototype)}};kt=yt=pt([st({type:Be.Set,itemType:Bt})],kt);let At=dt=class extends ut{constructor(e){super(e),Object.setPrototypeOf(this,dt.prototype)}};At=dt=pt([st({type:Be.Sequence,itemType:kt})],At);let St=gt=class extends At{constructor(e){super(e),Object.setPrototypeOf(this,gt.prototype)}};St=gt=pt([st({type:Be.Sequence})],St);const xt={fromASN:e=>mt.toString(Te.fromASN(e)),toASN:e=>Te.toASN(mt.fromString(e))};class It{constructor(e={}){this.typeId="",this.value=new ArrayBuffer(0),Object.assign(this,e)}}pt([at({type:ke.ObjectIdentifier})],It.prototype,"typeId",void 0),pt([at({type:ke.Any,context:0})],It.prototype,"value",void 0);class Ct{constructor(e={}){this.partyName=new ArrayBuffer(0),Object.assign(this,e)}}pt([at({type:bt,optional:!0,context:0,implicit:!0})],Ct.prototype,"nameAssigner",void 0),pt([at({type:bt,context:1,implicit:!0})],Ct.prototype,"partyName",void 0);let Ot=class{constructor(e={}){Object.assign(this,e)}};pt([at({type:It,context:0,implicit:!0})],Ot.prototype,"otherName",void 0),pt([at({type:ke.IA5String,context:1,implicit:!0})],Ot.prototype,"rfc822Name",void 0),pt([at({type:ke.IA5String,context:2,implicit:!0})],Ot.prototype,"dNSName",void 0),pt([at({type:ke.Any,context:3,implicit:!0})],Ot.prototype,"x400Address",void 0),pt([at({type:St,context:4,implicit:!1})],Ot.prototype,"directoryName",void 0),pt([at({type:Ct,context:5})],Ot.prototype,"ediPartyName",void 0),pt([at({type:ke.IA5String,context:6,implicit:!0})],Ot.prototype,"uniformResourceIdentifier",void 0),pt([at({type:ke.OctetString,context:7,implicit:!0,converter:xt})],Ot.prototype,"iPAddress",void 0),pt([at({type:ke.ObjectIdentifier,context:8,implicit:!0})],Ot.prototype,"registeredID",void 0),Ot=pt([st({type:Be.Choice})],Ot);var Nt;class Et{constructor(e={}){this.accessMethod="",this.accessLocation=new Ot,Object.assign(this,e)}}pt([at({type:ke.ObjectIdentifier})],Et.prototype,"accessMethod",void 0),pt([at({type:Ot})],Et.prototype,"accessLocation",void 0);let Tt=Nt=class extends ut{constructor(e){super(e),Object.setPrototypeOf(this,Nt.prototype)}};Tt=Nt=pt([st({type:Be.Sequence,itemType:Et})],Tt);const Ut="2.5.29.35";class Lt extends tt{}class jt{constructor(e={}){e&&Object.assign(this,e)}}pt([at({type:Lt,context:0,optional:!0,implicit:!0})],jt.prototype,"keyIdentifier",void 0),pt([at({type:Ot,context:1,optional:!0,implicit:!0,repeated:"sequence"})],jt.prototype,"authorityCertIssuer",void 0),pt([at({type:ke.Integer,context:2,optional:!0,implicit:!0,converter:Ce})],jt.prototype,"authorityCertSerialNumber",void 0);const Ht="2.5.29.19";class Rt{constructor(e={}){this.cA=!1,Object.assign(this,e)}}var Pt;pt([at({type:ke.Boolean,defaultValue:!1})],Rt.prototype,"cA",void 0),pt([at({type:ke.Integer,optional:!0})],Rt.prototype,"pathLenConstraint",void 0);let Dt=Pt=class extends ut{constructor(e){super(e),Object.setPrototypeOf(this,Pt.prototype)}};var _t;Dt=Pt=pt([st({type:Be.Sequence,itemType:Ot})],Dt);let $t=_t=class extends Dt{constructor(e){super(e),Object.setPrototypeOf(this,_t.prototype)}};var Ft;$t=_t=pt([st({type:Be.Sequence})],$t);const Vt="2.5.29.32";let zt=class{constructor(e={}){Object.assign(this,e)}toString(){return this.ia5String||this.visibleString||this.bmpString||this.utf8String}};pt([at({type:ke.IA5String})],zt.prototype,"ia5String",void 0),pt([at({type:ke.VisibleString})],zt.prototype,"visibleString",void 0),pt([at({type:ke.BmpString})],zt.prototype,"bmpString",void 0),pt([at({type:ke.Utf8String})],zt.prototype,"utf8String",void 0),zt=pt([st({type:Be.Choice})],zt);class Kt{constructor(e={}){this.organization=new zt,this.noticeNumbers=[],Object.assign(this,e)}}pt([at({type:zt})],Kt.prototype,"organization",void 0),pt([at({type:ke.Integer,repeated:"sequence"})],Kt.prototype,"noticeNumbers",void 0);class Mt{constructor(e={}){Object.assign(this,e)}}pt([at({type:Kt,optional:!0})],Mt.prototype,"noticeRef",void 0),pt([at({type:zt,optional:!0})],Mt.prototype,"explicitText",void 0);let qt=class{constructor(e={}){Object.assign(this,e)}};pt([at({type:ke.IA5String})],qt.prototype,"cPSuri",void 0),pt([at({type:Mt})],qt.prototype,"userNotice",void 0),qt=pt([st({type:Be.Choice})],qt);class Jt{constructor(e={}){this.policyQualifierId="",this.qualifier=new ArrayBuffer(0),Object.assign(this,e)}}pt([at({type:ke.ObjectIdentifier})],Jt.prototype,"policyQualifierId",void 0),pt([at({type:ke.Any})],Jt.prototype,"qualifier",void 0);class Gt{constructor(e={}){this.policyIdentifier="",Object.assign(this,e)}}pt([at({type:ke.ObjectIdentifier})],Gt.prototype,"policyIdentifier",void 0),pt([at({type:Jt,repeated:"sequence",optional:!0})],Gt.prototype,"policyQualifiers",void 0);let Wt=Ft=class extends ut{constructor(e){super(e),Object.setPrototypeOf(this,Ft.prototype)}};Wt=Ft=pt([st({type:Be.Sequence,itemType:Gt})],Wt);let Zt=class{constructor(e=0){this.value=e}};pt([at({type:ke.Integer})],Zt.prototype,"value",void 0),Zt=pt([st({type:Be.Choice})],Zt);let Yt=class extends Zt{};var Xt,Qt;Yt=pt([st({type:Be.Choice})],Yt),function(e){e[e.unused=1]="unused",e[e.keyCompromise=2]="keyCompromise",e[e.cACompromise=4]="cACompromise",e[e.affiliationChanged=8]="affiliationChanged",e[e.superseded=16]="superseded",e[e.cessationOfOperation=32]="cessationOfOperation",e[e.certificateHold=64]="certificateHold",e[e.privilegeWithdrawn=128]="privilegeWithdrawn",e[e.aACompromise=256]="aACompromise"}(Qt||(Qt={}));class er extends et{toJSON(){const e=[],t=this.toNumber();return t&Qt.aACompromise&&e.push("aACompromise"),t&Qt.affiliationChanged&&e.push("affiliationChanged"),t&Qt.cACompromise&&e.push("cACompromise"),t&Qt.certificateHold&&e.push("certificateHold"),t&Qt.cessationOfOperation&&e.push("cessationOfOperation"),t&Qt.keyCompromise&&e.push("keyCompromise"),t&Qt.privilegeWithdrawn&&e.push("privilegeWithdrawn"),t&Qt.superseded&&e.push("superseded"),t&Qt.unused&&e.push("unused"),e}toString(){return`[${this.toJSON().join(", ")}]`}}let tr=class{constructor(e={}){Object.assign(this,e)}};pt([at({type:Ot,context:0,repeated:"sequence",implicit:!0})],tr.prototype,"fullName",void 0),pt([at({type:kt,context:1,implicit:!0})],tr.prototype,"nameRelativeToCRLIssuer",void 0),tr=pt([st({type:Be.Choice})],tr);class rr{constructor(e={}){Object.assign(this,e)}}pt([at({type:tr,context:0,optional:!0})],rr.prototype,"distributionPoint",void 0),pt([at({type:er,context:1,optional:!0,implicit:!0})],rr.prototype,"reasons",void 0),pt([at({type:Ot,context:2,optional:!0,repeated:"sequence",implicit:!0})],rr.prototype,"cRLIssuer",void 0);let nr=Xt=class extends ut{constructor(e){super(e),Object.setPrototypeOf(this,Xt.prototype)}};var ir;nr=Xt=pt([st({type:Be.Sequence,itemType:rr})],nr);let or=ir=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,ir.prototype)}};or=ir=pt([st({type:Be.Sequence,itemType:rr})],or);class sr{constructor(e={}){this.onlyContainsUserCerts=sr.ONLY,this.onlyContainsCACerts=sr.ONLY,this.indirectCRL=sr.ONLY,this.onlyContainsAttributeCerts=sr.ONLY,Object.assign(this,e)}}var ar;sr.ONLY=!1,pt([at({type:tr,context:0,optional:!0})],sr.prototype,"distributionPoint",void 0),pt([at({type:ke.Boolean,context:1,defaultValue:sr.ONLY})],sr.prototype,"onlyContainsUserCerts",void 0),pt([at({type:ke.Boolean,context:2,defaultValue:sr.ONLY})],sr.prototype,"onlyContainsCACerts",void 0),pt([at({type:er,context:3,optional:!0})],sr.prototype,"onlySomeReasons",void 0),pt([at({type:ke.Boolean,context:4,defaultValue:sr.ONLY})],sr.prototype,"indirectCRL",void 0),pt([at({type:ke.Boolean,context:5,defaultValue:sr.ONLY})],sr.prototype,"onlyContainsAttributeCerts",void 0),function(e){e[e.unspecified=0]="unspecified",e[e.keyCompromise=1]="keyCompromise",e[e.cACompromise=2]="cACompromise",e[e.affiliationChanged=3]="affiliationChanged",e[e.superseded=4]="superseded",e[e.cessationOfOperation=5]="cessationOfOperation",e[e.certificateHold=6]="certificateHold",e[e.removeFromCRL=8]="removeFromCRL",e[e.privilegeWithdrawn=9]="privilegeWithdrawn",e[e.aACompromise=10]="aACompromise"}(ar||(ar={}));let cr=class{constructor(e=ar.unspecified){this.reason=ar.unspecified,this.reason=e}toJSON(){return ar[this.reason]}toString(){return this.toJSON()}};var lr;pt([at({type:ke.Enumerated})],cr.prototype,"reason",void 0),cr=pt([st({type:Be.Choice})],cr);const ur="2.5.29.37";let hr=lr=class extends ut{constructor(e){super(e),Object.setPrototypeOf(this,lr.prototype)}};hr=lr=pt([st({type:Be.Sequence,itemType:ke.ObjectIdentifier})],hr);let pr=class{constructor(e=new ArrayBuffer(0)){this.value=e}};pt([at({type:ke.Integer,converter:Ce})],pr.prototype,"value",void 0),pr=pt([st({type:Be.Choice})],pr);let fr=class{constructor(e){this.value=new Date,e&&(this.value=e)}};var yr;pt([at({type:ke.GeneralizedTime})],fr.prototype,"value",void 0),fr=pt([st({type:Be.Choice})],fr);let dr=yr=class extends Dt{constructor(e){super(e),Object.setPrototypeOf(this,yr.prototype)}};dr=yr=pt([st({type:Be.Sequence})],dr);const gr="2.5.29.15";var vr,mr;!function(e){e[e.digitalSignature=1]="digitalSignature",e[e.nonRepudiation=2]="nonRepudiation",e[e.keyEncipherment=4]="keyEncipherment",e[e.dataEncipherment=8]="dataEncipherment",e[e.keyAgreement=16]="keyAgreement",e[e.keyCertSign=32]="keyCertSign",e[e.cRLSign=64]="cRLSign",e[e.encipherOnly=128]="encipherOnly",e[e.decipherOnly=256]="decipherOnly"}(vr||(vr={}));class br extends et{toJSON(){const e=this.toNumber(),t=[];return e&vr.cRLSign&&t.push("crlSign"),e&vr.dataEncipherment&&t.push("dataEncipherment"),e&vr.decipherOnly&&t.push("decipherOnly"),e&vr.digitalSignature&&t.push("digitalSignature"),e&vr.encipherOnly&&t.push("encipherOnly"),e&vr.keyAgreement&&t.push("keyAgreement"),e&vr.keyCertSign&&t.push("keyCertSign"),e&vr.keyEncipherment&&t.push("keyEncipherment"),e&vr.nonRepudiation&&t.push("nonRepudiation"),t}toString(){return`[${this.toJSON().join(", ")}]`}}class wr{constructor(e={}){this.base=new Ot,this.minimum=0,Object.assign(this,e)}}pt([at({type:Ot})],wr.prototype,"base",void 0),pt([at({type:ke.Integer,context:0,defaultValue:0,implicit:!0})],wr.prototype,"minimum",void 0),pt([at({type:ke.Integer,context:1,optional:!0,implicit:!0})],wr.prototype,"maximum",void 0);let Br=mr=class extends ut{constructor(e){super(e),Object.setPrototypeOf(this,mr.prototype)}};Br=mr=pt([st({type:Be.Sequence,itemType:wr})],Br);class kr{constructor(e={}){Object.assign(this,e)}}pt([at({type:Br,context:0,optional:!0,implicit:!0})],kr.prototype,"permittedSubtrees",void 0),pt([at({type:Br,context:1,optional:!0,implicit:!0})],kr.prototype,"excludedSubtrees",void 0);class Ar{constructor(e={}){Object.assign(this,e)}}pt([at({type:ke.Integer,context:0,implicit:!0,optional:!0,converter:Ce})],Ar.prototype,"requireExplicitPolicy",void 0),pt([at({type:ke.Integer,context:1,implicit:!0,optional:!0,converter:Ce})],Ar.prototype,"inhibitPolicyMapping",void 0);class Sr{constructor(e={}){this.issuerDomainPolicy="",this.subjectDomainPolicy="",Object.assign(this,e)}}var xr;pt([at({type:ke.ObjectIdentifier})],Sr.prototype,"issuerDomainPolicy",void 0),pt([at({type:ke.ObjectIdentifier})],Sr.prototype,"subjectDomainPolicy",void 0);const Ir="2.5.29.17";let Cr=xr=class extends Dt{constructor(e){super(e),Object.setPrototypeOf(this,xr.prototype)}};Cr=xr=pt([st({type:Be.Sequence})],Cr);class Or{constructor(e={}){this.type="",this.values=[],Object.assign(this,e)}}var Nr;pt([at({type:ke.ObjectIdentifier})],Or.prototype,"type",void 0),pt([at({type:ke.Any,repeated:"set"})],Or.prototype,"values",void 0);let Er=Nr=class extends ut{constructor(e){super(e),Object.setPrototypeOf(this,Nr.prototype)}};Er=Nr=pt([st({type:Be.Sequence,itemType:Or})],Er);const Tr="2.5.29.14";class Ur extends Lt{}class Lr{constructor(e={}){Object.assign(this,e)}}var jr;pt([at({type:ke.GeneralizedTime,context:0,implicit:!0,optional:!0})],Lr.prototype,"notBefore",void 0),pt([at({type:ke.GeneralizedTime,context:1,implicit:!0,optional:!0})],Lr.prototype,"notAfter",void 0),function(e){e[e.keyUpdateAllowed=1]="keyUpdateAllowed",e[e.newExtensions=2]="newExtensions",e[e.pKIXCertificate=4]="pKIXCertificate"}(jr||(jr={}));class Hr extends et{toJSON(){const e=[],t=this.toNumber();return t&jr.pKIXCertificate&&e.push("pKIXCertificate"),t&jr.newExtensions&&e.push("newExtensions"),t&jr.keyUpdateAllowed&&e.push("keyUpdateAllowed"),e}toString(){return`[${this.toJSON().join(", ")}]`}}class Rr{constructor(e={}){this.entrustVers="",this.entrustInfoFlags=new Hr,Object.assign(this,e)}}pt([at({type:ke.GeneralString})],Rr.prototype,"entrustVers",void 0),pt([at({type:Hr})],Rr.prototype,"entrustInfoFlags",void 0);class Pr{constructor(e={}){this.algorithm="",Object.assign(this,e)}}pt([at({type:ke.ObjectIdentifier})],Pr.prototype,"algorithm",void 0),pt([at({type:ke.Any,optional:!0})],Pr.prototype,"parameters",void 0);class Dr{constructor(e={}){this.algorithm=new Pr,this.subjectPublicKey=new ArrayBuffer(0),Object.assign(this,e)}}pt([at({type:Pr})],Dr.prototype,"algorithm",void 0),pt([at({type:ke.BitString})],Dr.prototype,"subjectPublicKey",void 0);let _r=class{constructor(e){e&&("string"==typeof e||"number"==typeof e?this.utcTime=new Date(e):e instanceof Date?this.utcTime=e:Object.assign(this,e))}getTime(){const e=this.utcTime||this.generalTime;if(!e)throw new Error("Cannot get time from CHOICE object");return e}};pt([at({type:ke.UTCTime})],_r.prototype,"utcTime",void 0),pt([at({type:ke.GeneralizedTime})],_r.prototype,"generalTime",void 0),_r=pt([st({type:Be.Choice})],_r);class $r{constructor(e){this.notBefore=new _r(new Date),this.notAfter=new _r(new Date),e&&(this.notBefore=new _r(e.notBefore),this.notAfter=new _r(e.notAfter))}}var Fr;pt([at({type:_r})],$r.prototype,"notBefore",void 0),pt([at({type:_r})],$r.prototype,"notAfter",void 0);class Vr{constructor(e={}){this.extnID="",this.critical=Vr.CRITICAL,this.extnValue=new tt,Object.assign(this,e)}}Vr.CRITICAL=!1,pt([at({type:ke.ObjectIdentifier})],Vr.prototype,"extnID",void 0),pt([at({type:ke.Boolean,defaultValue:Vr.CRITICAL})],Vr.prototype,"critical",void 0),pt([at({type:tt})],Vr.prototype,"extnValue",void 0);let zr=Fr=class extends ut{constructor(e){super(e),Object.setPrototypeOf(this,Fr.prototype)}};var Kr;zr=Fr=pt([st({type:Be.Sequence,itemType:Vr})],zr),function(e){e[e.v1=0]="v1",e[e.v2=1]="v2",e[e.v3=2]="v3"}(Kr||(Kr={}));class Mr{constructor(e={}){this.version=Kr.v1,this.serialNumber=new ArrayBuffer(0),this.signature=new Pr,this.issuer=new St,this.validity=new $r,this.subject=new St,this.subjectPublicKeyInfo=new Dr,Object.assign(this,e)}}pt([at({type:ke.Integer,context:0,defaultValue:Kr.v1})],Mr.prototype,"version",void 0),pt([at({type:ke.Integer,converter:Ce})],Mr.prototype,"serialNumber",void 0),pt([at({type:Pr})],Mr.prototype,"signature",void 0),pt([at({type:St})],Mr.prototype,"issuer",void 0),pt([at({type:$r})],Mr.prototype,"validity",void 0),pt([at({type:St})],Mr.prototype,"subject",void 0),pt([at({type:Dr})],Mr.prototype,"subjectPublicKeyInfo",void 0),pt([at({type:ke.BitString,context:1,implicit:!0,optional:!0})],Mr.prototype,"issuerUniqueID",void 0),pt([at({type:ke.BitString,context:2,implicit:!0,optional:!0})],Mr.prototype,"subjectUniqueID",void 0),pt([at({type:zr,context:3,optional:!0})],Mr.prototype,"extensions",void 0);class qr{constructor(e={}){this.tbsCertificate=new Mr,this.signatureAlgorithm=new Pr,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}}pt([at({type:Mr})],qr.prototype,"tbsCertificate",void 0),pt([at({type:Pr})],qr.prototype,"signatureAlgorithm",void 0),pt([at({type:ke.BitString})],qr.prototype,"signatureValue",void 0);class Jr{constructor(e={}){this.userCertificate=new ArrayBuffer(0),this.revocationDate=new _r,Object.assign(this,e)}}pt([at({type:ke.Integer,converter:Ce})],Jr.prototype,"userCertificate",void 0),pt([at({type:_r})],Jr.prototype,"revocationDate",void 0),pt([at({type:Vr,optional:!0,repeated:"sequence"})],Jr.prototype,"crlEntryExtensions",void 0);class Gr{constructor(e={}){this.signature=new Pr,this.issuer=new St,this.thisUpdate=new _r,Object.assign(this,e)}}pt([at({type:ke.Integer,optional:!0})],Gr.prototype,"version",void 0),pt([at({type:Pr})],Gr.prototype,"signature",void 0),pt([at({type:St})],Gr.prototype,"issuer",void 0),pt([at({type:_r})],Gr.prototype,"thisUpdate",void 0),pt([at({type:_r,optional:!0})],Gr.prototype,"nextUpdate",void 0),pt([at({type:Jr,repeated:"sequence",optional:!0})],Gr.prototype,"revokedCertificates",void 0),pt([at({type:Vr,optional:!0,context:0,repeated:"sequence"})],Gr.prototype,"crlExtensions",void 0);class Wr{constructor(e={}){this.tbsCertList=new Gr,this.signatureAlgorithm=new Pr,this.signature=new ArrayBuffer(0),Object.assign(this,e)}}pt([at({type:Gr})],Wr.prototype,"tbsCertList",void 0),pt([at({type:Pr})],Wr.prototype,"signatureAlgorithm",void 0),pt([at({type:ke.BitString})],Wr.prototype,"signature",void 0);class Zr{constructor(...e){if(1===e.length){const t=e[0];this.rawData=ht.serialize(t),this.onInit(t)}else{const t=ht.parse(e[0],e[1]);this.rawData=We.toArrayBuffer(e[0]),this.onInit(t)}}equal(e){return e instanceof Zr&&Qe(e.rawData,this.rawData)}}class Yr extends Zr{constructor(...e){let t;t=We.isBufferSource(e[0])?We.toArrayBuffer(e[0]):ht.serialize(new Vr({extnID:e[0],critical:e[1],extnValue:new tt(We.toArrayBuffer(e[2]))})),super(t,Vr)}onInit(e){this.type=e.extnID,this.critical=e.critical,this.value=e.extnValue.buffer}}class Xr extends Map{constructor(){super(),"undefined"!=typeof self&&"undefined"!=typeof crypto&&this.set(Xr.DEFAULT,crypto)}static isCryptoKeyPair(e){return e&&e.privateKey&&e.publicKey}static isCryptoKey(e){return e&&e.usages&&e.type&&e.algorithm&&void 0!==e.extractable}get(e=Xr.DEFAULT){const t=super.get(e.toLowerCase());if(!t)throw new Error(`Cannot get Crypto by name '${e}'`);return t}set(e,t){if("string"==typeof e){if(!t)throw new TypeError("Argument 'value' is required");super.set(e.toLowerCase(),t)}else super.set(Xr.DEFAULT,e);return this}}Xr.DEFAULT="default";const Qr=new Xr,en="1.2.840.113549.1.1",tn=`${en}.1`,rn=`${en}.7`,nn=`${en}.9`,on=`${en}.10`,sn=`${en}.2`,an=`${en}.4`,cn=`${en}.5`,ln=`${en}.11`,un=`${en}.12`,hn=`${en}.13`,pn=`${en}.15`,fn=`${en}.16`,yn=`${en}.8`;function dn(e){return new Pr({algorithm:e,parameters:null})}dn("1.2.840.113549.2.2"),dn("1.2.840.113549.2.5");const gn=dn("1.3.14.3.2.26");dn("2.16.840.1.101.3.4.2.4"),dn("2.16.840.1.101.3.4.2.1"),dn("2.16.840.1.101.3.4.2.2"),dn("2.16.840.1.101.3.4.2.3"),dn("2.16.840.1.101.3.4.2.5"),dn("2.16.840.1.101.3.4.2.6");const vn=new Pr({algorithm:yn,parameters:ht.serialize(gn)}),mn=new Pr({algorithm:nn,parameters:ht.serialize(Te.toASN(new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]).buffer))});dn(tn),dn(sn),dn(an),dn(cn),dn(pn),dn(fn),dn(un),dn(hn),dn(pn),dn(fn);class bn{constructor(e={}){this.hashAlgorithm=new Pr(gn),this.maskGenAlgorithm=new Pr({algorithm:yn,parameters:ht.serialize(gn)}),this.pSourceAlgorithm=new Pr(mn),Object.assign(this,e)}}pt([at({type:Pr,context:0,defaultValue:gn})],bn.prototype,"hashAlgorithm",void 0),pt([at({type:Pr,context:1,defaultValue:vn})],bn.prototype,"maskGenAlgorithm",void 0),pt([at({type:Pr,context:2,defaultValue:mn})],bn.prototype,"pSourceAlgorithm",void 0),new Pr({algorithm:rn,parameters:ht.serialize(new bn)});class wn{constructor(e={}){this.hashAlgorithm=new Pr(gn),this.maskGenAlgorithm=new Pr({algorithm:yn,parameters:ht.serialize(gn)}),this.saltLength=20,this.trailerField=1,Object.assign(this,e)}}pt([at({type:Pr,context:0,defaultValue:gn})],wn.prototype,"hashAlgorithm",void 0),pt([at({type:Pr,context:1,defaultValue:vn})],wn.prototype,"maskGenAlgorithm",void 0),pt([at({type:ke.Integer,context:2,defaultValue:20})],wn.prototype,"saltLength",void 0),pt([at({type:ke.Integer,context:3,defaultValue:1})],wn.prototype,"trailerField",void 0),new Pr({algorithm:on,parameters:ht.serialize(new wn)});class Bn{constructor(e={}){this.digestAlgorithm=new Pr,this.digest=new tt,Object.assign(this,e)}}var kn;pt([at({type:Pr})],Bn.prototype,"digestAlgorithm",void 0),pt([at({type:tt})],Bn.prototype,"digest",void 0);class An{constructor(e={}){this.prime=new ArrayBuffer(0),this.exponent=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}}pt([at({type:ke.Integer,converter:Ce})],An.prototype,"prime",void 0),pt([at({type:ke.Integer,converter:Ce})],An.prototype,"exponent",void 0),pt([at({type:ke.Integer,converter:Ce})],An.prototype,"coefficient",void 0);let Sn=kn=class extends ut{constructor(e){super(e),Object.setPrototypeOf(this,kn.prototype)}};Sn=kn=pt([st({type:Be.Sequence,itemType:An})],Sn);class xn{constructor(e={}){this.version=0,this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),this.privateExponent=new ArrayBuffer(0),this.prime1=new ArrayBuffer(0),this.prime2=new ArrayBuffer(0),this.exponent1=new ArrayBuffer(0),this.exponent2=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}}pt([at({type:ke.Integer})],xn.prototype,"version",void 0),pt([at({type:ke.Integer,converter:Ce})],xn.prototype,"modulus",void 0),pt([at({type:ke.Integer,converter:Ce})],xn.prototype,"publicExponent",void 0),pt([at({type:ke.Integer,converter:Ce})],xn.prototype,"privateExponent",void 0),pt([at({type:ke.Integer,converter:Ce})],xn.prototype,"prime1",void 0),pt([at({type:ke.Integer,converter:Ce})],xn.prototype,"prime2",void 0),pt([at({type:ke.Integer,converter:Ce})],xn.prototype,"exponent1",void 0),pt([at({type:ke.Integer,converter:Ce})],xn.prototype,"exponent2",void 0),pt([at({type:ke.Integer,converter:Ce})],xn.prototype,"coefficient",void 0),pt([at({type:Sn,optional:!0})],xn.prototype,"otherPrimeInfos",void 0);class In{constructor(e={}){this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),Object.assign(this,e)}}var Cn;pt([at({type:ke.Integer,converter:Ce})],In.prototype,"modulus",void 0),pt([at({type:ke.Integer,converter:Ce})],In.prototype,"publicExponent",void 0),function(e){e[e.Transient=0]="Transient",e[e.Singleton=1]="Singleton",e[e.ResolutionScoped=2]="ResolutionScoped",e[e.ContainerScoped=3]="ContainerScoped"}(Cn||(Cn={}));var On=Cn,Nn=function(e,t){return Nn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},Nn(e,t)};
/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */function En(e,t){function r(){this.constructor=e}Nn(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function Tn(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Un(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}function Ln(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Un(arguments[t]));return e}function jn(e){return!!e.useClass}function Hn(e){return!!e.useFactory}var Rn=function(){function e(e){this.wrap=e,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}return e.prototype.createProxy=function(e){var t,r=this,n=!1;return new Proxy({},this.createHandler((function(){return n||(t=e(r.wrap()),n=!0),t})))},e.prototype.createHandler=function(e){var t={};return this.reflectMethods.forEach((function(r){t[r]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t[0]=e();var i=Reflect[r];return i.apply(void 0,Ln(t))}})),t},e}();function Pn(e){return"string"==typeof e||"symbol"==typeof e}function Dn(e){return"object"==typeof e&&"token"in e&&"transform"in e}function _n(e){return!!e.useToken}function $n(e){return null!=e.useValue}var Fn=function(){function e(){this._registryMap=new Map}return e.prototype.entries=function(){return this._registryMap.entries()},e.prototype.getAll=function(e){return this.ensure(e),this._registryMap.get(e)},e.prototype.get=function(e){this.ensure(e);var t=this._registryMap.get(e);return t[t.length-1]||null},e.prototype.set=function(e,t){this.ensure(e),this._registryMap.get(e).push(t)},e.prototype.setAll=function(e,t){this._registryMap.set(e,t)},e.prototype.has=function(e){return this.ensure(e),this._registryMap.get(e).length>0},e.prototype.clear=function(){this._registryMap.clear()},e.prototype.ensure=function(e){this._registryMap.has(e)||this._registryMap.set(e,[])},e}(),Vn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return En(t,e),t}(Fn),zn=function(){this.scopedResolutions=new Map};function Kn(e,t,r){var n,i,o=Un(e.toString().match(/constructor\(([\w, ]+)\)/)||[],2)[1],s=function(e,t){return null===e?"at position #"+t:'"'+e.split(",")[t].trim()+'" at position #'+t}(void 0===o?null:o,t);return n="Cannot inject the dependency "+s+' of "'+e.name+'" constructor. Reason:',void 0===i&&(i="    "),Ln([n],r.message.split("\n").map((function(e){return i+e}))).join("\n")}var Mn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return En(t,e),t}(Fn),qn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return En(t,e),t}(Fn),Jn=function(){this.preResolution=new Mn,this.postResolution=new qn},Gn=new Map,Wn=function(){function e(e){this.parent=e,this._registry=new Vn,this.interceptors=new Jn}return e.prototype.register=function(e,t,r){var n;if(void 0===r&&(r={lifecycle:On.Transient}),n=function(e){return jn(e)||$n(e)||_n(e)||Hn(e)}(t)?t:{useClass:t},_n(n))for(var i=[e],o=n;null!=o;){var s=o.useToken;if(i.includes(s))throw new Error("Token registration cycle detected! "+Ln(i,[s]).join(" -> "));i.push(s);var a=this._registry.get(s);o=a&&_n(a.provider)?a.provider:null}if((r.lifecycle===On.Singleton||r.lifecycle==On.ContainerScoped||r.lifecycle==On.ResolutionScoped)&&($n(n)||Hn(n)))throw new Error('Cannot use lifecycle "'+On[r.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(e,{provider:n,options:r}),this},e.prototype.registerType=function(e,t){return Pn(t)?this.register(e,{useToken:t}):this.register(e,{useClass:t})},e.prototype.registerInstance=function(e,t){return this.register(e,{useValue:t})},e.prototype.registerSingleton=function(e,t){if(Pn(e)){if(Pn(t))return this.register(e,{useToken:t},{lifecycle:On.Singleton});if(t)return this.register(e,{useClass:t},{lifecycle:On.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}var r=e;return t&&!Pn(t)&&(r=t),this.register(e,{useClass:r},{lifecycle:On.Singleton})},e.prototype.resolve=function(e,t){void 0===t&&(t=new zn);var r=this.getRegistration(e);if(!r&&Pn(e))throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"');if(this.executePreResolutionInterceptor(e,"Single"),r){var n=this.resolveRegistration(r,t);return this.executePostResolutionInterceptor(e,n,"Single"),n}if(function(e){return"function"==typeof e||e instanceof Rn}(e)){n=this.construct(e,t);return this.executePostResolutionInterceptor(e,n,"Single"),n}throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},e.prototype.executePreResolutionInterceptor=function(e,t){var r,n;if(this.interceptors.preResolution.has(e)){var i=[];try{for(var o=Tn(this.interceptors.preResolution.getAll(e)),s=o.next();!s.done;s=o.next()){var a=s.value;"Once"!=a.options.frequency&&i.push(a),a.callback(e,t)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}this.interceptors.preResolution.setAll(e,i)}},e.prototype.executePostResolutionInterceptor=function(e,t,r){var n,i;if(this.interceptors.postResolution.has(e)){var o=[];try{for(var s=Tn(this.interceptors.postResolution.getAll(e)),a=s.next();!a.done;a=s.next()){var c=a.value;"Once"!=c.options.frequency&&o.push(c),c.callback(e,t,r)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}this.interceptors.postResolution.setAll(e,o)}},e.prototype.resolveRegistration=function(e,t){if(e.options.lifecycle===On.ResolutionScoped&&t.scopedResolutions.has(e))return t.scopedResolutions.get(e);var r,n=e.options.lifecycle===On.Singleton,i=e.options.lifecycle===On.ContainerScoped,o=n||i;return r=$n(e.provider)?e.provider.useValue:_n(e.provider)?o?e.instance||(e.instance=this.resolve(e.provider.useToken,t)):this.resolve(e.provider.useToken,t):jn(e.provider)?o?e.instance||(e.instance=this.construct(e.provider.useClass,t)):this.construct(e.provider.useClass,t):Hn(e.provider)?e.provider.useFactory(this):this.construct(e.provider,t),e.options.lifecycle===On.ResolutionScoped&&t.scopedResolutions.set(e,r),r},e.prototype.resolveAll=function(e,t){var r=this;void 0===t&&(t=new zn);var n=this.getAllRegistrations(e);if(!n&&Pn(e))throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"');if(this.executePreResolutionInterceptor(e,"All"),n){var i=n.map((function(e){return r.resolveRegistration(e,t)}));return this.executePostResolutionInterceptor(e,i,"All"),i}var o=[this.construct(e,t)];return this.executePostResolutionInterceptor(e,o,"All"),o},e.prototype.isRegistered=function(e,t){return void 0===t&&(t=!1),this._registry.has(e)||t&&(this.parent||!1)&&this.parent.isRegistered(e,!0)},e.prototype.reset=function(){this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},e.prototype.clearInstances=function(){var e,t;try{for(var r=Tn(this._registry.entries()),n=r.next();!n.done;n=r.next()){var i=Un(n.value,2),o=i[0],s=i[1];this._registry.setAll(o,s.filter((function(e){return!$n(e.provider)})).map((function(e){return e.instance=void 0,e})))}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},e.prototype.createChildContainer=function(){var t,r,n=new e(this);try{for(var i=Tn(this._registry.entries()),o=i.next();!o.done;o=i.next()){var s=Un(o.value,2),a=s[0],c=s[1];c.some((function(e){return e.options.lifecycle===On.ContainerScoped}))&&n._registry.setAll(a,c.map((function(e){return e.options.lifecycle===On.ContainerScoped?{provider:e.provider,options:e.options}:e})))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return n},e.prototype.beforeResolution=function(e,t,r){void 0===r&&(r={frequency:"Always"}),this.interceptors.preResolution.set(e,{callback:t,options:r})},e.prototype.afterResolution=function(e,t,r){void 0===r&&(r={frequency:"Always"}),this.interceptors.postResolution.set(e,{callback:t,options:r})},e.prototype.getRegistration=function(e){return this.isRegistered(e)?this._registry.get(e):this.parent?this.parent.getRegistration(e):null},e.prototype.getAllRegistrations=function(e){return this.isRegistered(e)?this._registry.getAll(e):this.parent?this.parent.getAllRegistrations(e):null},e.prototype.construct=function(e,t){var r=this;if(e instanceof Rn)return e.createProxy((function(e){return r.resolve(e,t)}));var n=Gn.get(e);if(!n||0===n.length){if(0===e.length)return new e;throw new Error('TypeInfo not known for "'+e.name+'"')}var i=n.map(this.resolveParams(t,e));return new(e.bind.apply(e,Ln([void 0],i)))},e.prototype.resolveParams=function(e,t){var r=this;return function(n,i){var o,s,a,c;try{return"object"==typeof(c=n)&&"token"in c&&"multiple"in c?Dn(n)?n.multiple?(o=r.resolve(n.transform)).transform.apply(o,Ln([r.resolveAll(n.token)],n.transformArgs)):(s=r.resolve(n.transform)).transform.apply(s,Ln([r.resolve(n.token,e)],n.transformArgs)):n.multiple?r.resolveAll(n.token):r.resolve(n.token,e):Dn(n)?(a=r.resolve(n.transform,e)).transform.apply(a,Ln([r.resolve(n.token,e)],n.transformArgs)):r.resolve(n,e)}catch(e){throw new Error(Kn(t,i,e))}}},e}(),Zn=new Wn;function Yn(){return function(e){Gn.set(e,function(e){var t=Reflect.getMetadata("design:paramtypes",e)||[],r=Reflect.getOwnMetadata("injectionTokens",e)||{};return Object.keys(r).forEach((function(e){t[+e]=r[e]})),t}(e))}}if("undefined"==typeof Reflect||!Reflect.getMetadata)throw new Error("tsyringe requires a reflect polyfill. Please add 'import \"reflect-metadata\"' to the top of your entry point.");const Xn="crypto.algorithm";class Qn{getAlgorithms(){return Zn.resolveAll(Xn)}toAsnAlgorithm(e){for(const t of this.getAlgorithms()){const r=t.toAsnAlgorithm(e);if(r)return r}if(/[0-9.]+/.test(e.name)){const t=new Pr({algorithm:e.name});if("parameters"in e){const r=e;t.parameters=r.parameters}return t}throw new Error("Cannot convert WebCrypto algorithm to ASN.1 algorithm")}toWebAlgorithm(e){for(const t of this.getAlgorithms()){const r=t.toWebAlgorithm(e);if(r)return r}return{name:e.algorithm,parameters:e.parameters}}}const ei="crypto.algorithmProvider";Zn.registerSingleton(ei,Qn);class ti{constructor(){this.CertificateTag="CERTIFICATE",this.CertificateRequestTag="CERTIFICATE REQUEST",this.PublicKeyTag="PUBLIC KEY",this.PrivateKeyTag="PRIVATE KEY"}static isPem(e){return"string"==typeof e&&/-{5}BEGIN [A-Z0-9 ]+-{5}([a-zA-Z0-9=+/\n\r]+)-{5}END [A-Z0-9 ]+-{5}/g.test(e)}static decode(e){const t=/-{5}BEGIN [A-Z0-9 ]+-{5}([a-zA-Z0-9=+/\n\r]+)-{5}END [A-Z0-9 ]+-{5}/g,r=[];let n=null;for(;n=t.exec(e);){const e=n[1].replace(/\r/g,"").replace(/\n/g,"");r.push(Xe.FromBase64(e))}return r}static encode(e,t){if(Array.isArray(e)){const r=new Array;return e.forEach((e=>{r.push(this.encodeBuffer(e,t))})),r.join("\n")}return this.encodeBuffer(e,t)}static encodeBuffer(e,t){const r=Xe.ToBase64(e);let n,i=0;const o=Array();for(;i<r.length&&(r.length-i<64?n=r.substring(i):(n=r.substring(i,i+64),i+=64),0!==n.length)&&(o.push(n),!(n.length<64)););const s=t.toLocaleUpperCase();return`-----BEGIN ${s}-----\n${o.join("\n")}\n-----END ${s}-----`}}class ri extends Zr{static isAsnEncoded(e){return We.isBufferSource(e)||"string"==typeof e}static toArrayBuffer(e){if("string"==typeof e){if(ti.isPem(e))return ti.decode(e)[0];if(Xe.isHex(e))return Xe.FromHex(e);if(Xe.isBase64(e))return Xe.FromBase64(e);if(Xe.isBase64Url(e))return Xe.FromBase64Url(e);throw new TypeError("Unsupported format of 'raw' argument. Must be one of DER, PEM, HEX, Base64, or Base4Url")}{const t=Xe.ToBinary(e);return ti.isPem(t)?ti.decode(t)[0]:Xe.isHex(t)?Xe.FromHex(t):Xe.isBase64(t)?Xe.FromBase64(t):Xe.isBase64Url(t)?Xe.FromBase64Url(t):We.toArrayBuffer(e)}}constructor(...e){ri.isAsnEncoded(e[0])?super(ri.toArrayBuffer(e[0]),e[1]):super(e[0])}toString(e="pem"){switch(e){case"pem":return ti.encode(this.rawData,this.tag);case"hex":return Xe.ToHex(this.rawData);case"base64":return Xe.ToBase64(this.rawData);case"base64url":return Xe.ToBase64Url(this.rawData);default:throw TypeError("Argument 'format' is unsupported value")}}}class ni extends ri{constructor(e){ri.isAsnEncoded(e)?super(e,Dr):super(e),this.tag="PUBLIC KEY"}async export(...e){let t,r=["verify"],n={hash:"SHA-256",...this.algorithm};return e.length>1?(n=e[0]||n,r=e[1]||r,t=e[2]||Qr.get()):t=e[0]||Qr.get(),t.subtle.importKey("spki",this.rawData,n,!0,r)}onInit(e){const t=Zn.resolve(ei),r=this.algorithm=t.toWebAlgorithm(e.algorithm);switch(e.algorithm.algorithm){case tn:{const t=ht.parse(e.subjectPublicKey,In),n=We.toUint8Array(t.modulus);r.publicExponent=We.toUint8Array(t.publicExponent),r.modulusLength=(n[0]?n:n.slice(1)).byteLength<<3;break}}}async getThumbprint(...e){var t;let r,n="SHA-1";return e.length>=1&&!(null===(t=e[0])||void 0===t?void 0:t.subtle)?(n=e[0]||n,r=e[1]||Qr.get()):r=e[0]||Qr.get(),await r.subtle.digest(n,this.rawData)}async getKeyIdentifier(e){e||(e=Qr.get());const t=ht.parse(this.rawData,Dr);return await e.subtle.digest("SHA-1",t.subjectPublicKey)}}class ii{constructor(){this.items={}}get(e){return this.items[e]||null}register(e,t){this.items[e]=t,this.items[t]=e}}const oi=new ii;function si(e,t){return`\\${Xe.ToHex(Xe.FromUtf8String(t)).toUpperCase()}`}oi.register("CN","2.5.4.3"),oi.register("L","2.5.4.7"),oi.register("ST","2.5.4.8"),oi.register("O","2.5.4.10"),oi.register("OU","2.5.4.11"),oi.register("C","2.5.4.6"),oi.register("DC","0.9.2342.19200300.100.1.25"),oi.register("E","1.2.840.113549.1.9.1"),oi.register("G","2.5.4.42"),oi.register("I","2.5.4.43"),oi.register("SN","2.5.4.4"),oi.register("T","2.5.4.12");class ai{constructor(e,t={}){this.extraNames=new ii,this.asn=new St;for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const r=t[e];this.extraNames.register(e,r)}"string"==typeof e?this.asn=this.fromString(e):e instanceof St?this.asn=e:We.isBufferSource(e)?this.asn=ht.parse(e,St):this.asn=this.fromJSON(e)}static isASCII(e){for(let t=0;t<e.length;t++){if(e.charCodeAt(t)>255)return!1}return!0}getName(e){return this.extraNames.get(e)||oi.get(e)}toString(){return this.asn.map((e=>e.map((e=>`${this.getName(e.type)||e.type}=${e.value.anyValue?`#${Xe.ToHex(e.value.anyValue)}`:e.value.toString().replace(/([,+"\\<>;])/g,"\\$1").replace(/^([ #])/,"\\$1").replace(/([ ]$)/,"\\$1").replace(/([\r\n\t])/,si)}`)).join("+"))).join(", ")}toJSON(){var e;const t=[];for(const r of this.asn){const n={};for(const t of r){const r=this.getName(t.type)||t.type;null!==(e=n[r])&&void 0!==e||(n[r]=[]),n[r].push(t.value.anyValue?`#${Xe.ToHex(t.value.anyValue)}`:t.value.toString())}t.push(n)}return t}fromString(e){const t=new St,r=/(\d\.[\d.]*\d|[A-Za-z]+)=((?:"")|(?:".*?[^\\]")|(?:[^,+].*?(?:[^\\][,+]))|(?:))([,+])?/g;let n=null,i=",";for(;n=r.exec(`${e},`);){let[,e,r]=n;const o=r[r.length-1];","!==o&&"+"!==o||(r=r.slice(0,r.length-1),n[3]=o);const s=n[3];if(/[\d.]+/.test(e)||(e=this.getName(e)||""),!e)throw new Error(`Cannot get OID for name type '${e}'`);const a=new Bt({type:e});if("#"===r.charAt(0))a.value.anyValue=Xe.FromHex(r.slice(1));else{const t=/"(.*?[^\\])?"/.exec(r);t&&(r=t[1]),r=r.replace(/\\0a/gi,"\n").replace(/\\0d/gi,"\r").replace(/\\0g/gi,"\t").replace(/\\(.)/g,"$1"),e===this.getName("E")||e===this.getName("DC")?a.value.ia5String=r:ai.isASCII(r)?a.value.printableString=r:a.value.utf8String=r}"+"===i?t[t.length-1].push(a):t.push(new kt([a])),i=s}return t}fromJSON(e){const t=new St;for(const r of e){const e=new kt;for(const t in r){let n=t;if(/[\d.]+/.test(t)||(n=this.getName(t)||""),!n)throw new Error(`Cannot get OID for name type '${t}'`);const i=r[t];for(const t of i){const r=new Bt({type:n});"#"===t[0]?r.value.anyValue=Xe.FromHex(t.slice(1)):n===this.getName("E")||n===this.getName("DC")?r.value.ia5String=t:r.value.printableString=t,e.push(r)}}t.push(e)}return t}toArrayBuffer(){return ht.serialize(this.asn)}async getThumbprint(...e){var t;let r,n="SHA-1";return e.length>=1&&!(null===(t=e[0])||void 0===t?void 0:t.subtle)?(n=e[0]||n,r=e[1]||Qr.get()):r=e[0]||Qr.get(),await r.subtle.digest(n,this.toArrayBuffer())}}class ci{static register(e,t){this.items.set(e,t)}static create(e){const t=new Yr(e),r=this.items.get(t.type);return r?new r(e):t}}ci.items=new Map;const li="crypto.signatureFormatter";class ui{toAsnSignature(e,t){return We.toArrayBuffer(t)}toWebSignature(e,t){return We.toArrayBuffer(t)}}class hi extends ri{constructor(e){ri.isAsnEncoded(e)?super(e,qr):super(e),this.tag="CERTIFICATE"}onInit(e){const t=e.tbsCertificate;this.tbs=ht.serialize(t),this.serialNumber=Xe.ToHex(t.serialNumber),this.subjectName=new ai(t.subject),this.subject=new ai(t.subject).toString(),this.issuerName=new ai(t.issuer),this.issuer=this.issuerName.toString();const r=Zn.resolve(ei);this.signatureAlgorithm=r.toWebAlgorithm(e.signatureAlgorithm),this.signature=e.signatureValue;const n=t.validity.notBefore.utcTime||t.validity.notBefore.generalTime;if(!n)throw new Error("Cannot get 'notBefore' value");this.notBefore=n;const i=t.validity.notAfter.utcTime||t.validity.notAfter.generalTime;if(!i)throw new Error("Cannot get 'notAfter' value");this.notAfter=i,this.extensions=[],t.extensions&&(this.extensions=t.extensions.map((e=>ci.create(ht.serialize(e))))),this.publicKey=new ni(t.subjectPublicKeyInfo)}getExtension(e){for(const t of this.extensions)if("string"==typeof e){if(t.type===e)return t}else if(t instanceof e)return t;return null}getExtensions(e){return this.extensions.filter((t=>"string"==typeof e?t.type===e:t instanceof e))}async verify(e={},t=Qr.get()){let r,n;const i=e.publicKey;try{i?i instanceof hi?(r={...i.publicKey.algorithm,...this.signatureAlgorithm},n=await i.publicKey.export(r,["verify"])):i instanceof ni?(r={...i.algorithm,...this.signatureAlgorithm},n=await i.export(r,["verify"])):(r={...i.algorithm,...this.signatureAlgorithm},n=i):(r={...this.publicKey.algorithm,...this.signatureAlgorithm},n=await this.publicKey.export(r,["verify"],t))}catch(e){return!1}const o=Zn.resolveAll(li).reverse();let s=null;for(const e of o)if(s=e.toWebSignature(r,this.signature),s)break;if(!s)throw Error("Cannot convert ASN.1 signature value to WebCrypto format");const a=await t.subtle.verify(this.signatureAlgorithm,n,s,this.tbs);if(e.signatureOnly)return a;{const t=(e.date||new Date).getTime();return a&&this.notBefore.getTime()<t&&t<this.notAfter.getTime()}}async getThumbprint(...e){let t,r="SHA-1";return e[0]&&(e[0].subtle?t=e[0]:(r=e[0]||r,t=e[1])),null!=t||(t=Qr.get()),await t.subtle.digest(r,this.rawData)}async isSelfSigned(){return this.subject===this.issuer&&await this.verify({signatureOnly:!0})}}class pi extends Yr{constructor(...e){if(We.isBufferSource(e[0]))super(e[0]);else if("string"==typeof e[0]){const t=new jt({keyIdentifier:new tt(Xe.FromHex(e[0]))});super(Ut,e[1],ht.serialize(t))}else{const t=e[0],r=new jt({authorityCertIssuer:t.name,authorityCertSerialNumber:Xe.FromHex(t.serialNumber)});super(Ut,e[1],ht.serialize(r))}}static async create(e,t=!1,r=Qr.get()){if(e instanceof hi||Xr.isCryptoKey(e)){const n=e instanceof hi?await e.publicKey.export(r):e,i=await r.subtle.exportKey("spki",n),o=new ni(i),s=await o.getKeyIdentifier(r);return new pi(Xe.ToHex(s),t)}return new pi(e,t)}onInit(e){super.onInit(e);const t=ht.parse(e.extnValue,jt);t.keyIdentifier&&(this.keyId=Xe.ToHex(t.keyIdentifier)),t.authorityCertIssuer&&t.authorityCertSerialNumber&&(this.certId={name:t.authorityCertIssuer,serialNumber:Xe.ToHex(t.authorityCertSerialNumber)})}}class fi extends Yr{constructor(...e){if(We.isBufferSource(e[0])){super(e[0]);const t=ht.parse(this.value,Rt);this.ca=t.cA,this.pathLength=t.pathLenConstraint}else{const t=new Rt({cA:e[0],pathLenConstraint:e[1]});super(Ht,e[2],ht.serialize(t)),this.ca=e[0],this.pathLength=e[1]}}}class yi extends Yr{constructor(...e){if(We.isBufferSource(e[0])){super(e[0]);const t=ht.parse(this.value,hr);this.usages=t.map((e=>e))}else{const t=new hr(e[0]);super(ur,e[1],ht.serialize(t)),this.usages=e[0]}}}e.KeyUsageFlags=void 0,function(e){e[e.digitalSignature=1]="digitalSignature",e[e.nonRepudiation=2]="nonRepudiation",e[e.keyEncipherment=4]="keyEncipherment",e[e.dataEncipherment=8]="dataEncipherment",e[e.keyAgreement=16]="keyAgreement",e[e.keyCertSign=32]="keyCertSign",e[e.cRLSign=64]="cRLSign",e[e.encipherOnly=128]="encipherOnly",e[e.decipherOnly=256]="decipherOnly"}(e.KeyUsageFlags||(e.KeyUsageFlags={}));class di extends Yr{constructor(...e){if(We.isBufferSource(e[0])){super(e[0]);const t=ht.parse(this.value,br);this.usages=t.toNumber()}else{const t=new br(e[0]);super(gr,e[1],ht.serialize(t)),this.usages=e[0]}}}class gi extends Yr{constructor(...e){if(We.isBufferSource(e[0])){super(e[0]);const t=ht.parse(this.value,Ur);this.keyId=Xe.ToHex(t)}else{const t="string"==typeof e[0]?Xe.FromHex(e[0]):e[0],r=new Ur(t);super(Tr,e[1],ht.serialize(r)),this.keyId=Xe.ToHex(t)}}static async create(e,t=!1,r=Qr.get()){const n=await r.subtle.exportKey("spki",e),i=new ni(n),o=await i.getKeyIdentifier(r);return new gi(Xe.ToHex(o),t)}}class vi extends Zr{constructor(...e){let t;if(We.isBufferSource(e[0]))t=We.toArrayBuffer(e[0]);else{const r=e[0],n=We.toArrayBuffer(e[1]);t=ht.serialize(new It({typeId:r,value:n}))}super(t,It)}onInit(e){this.type=e.typeId,this.value=e.value}toJSON(){return{type:this.type,value:Xe.ToHex(this.value)}}}class mi extends Yr{constructor(...e){if(We.isBufferSource(e[0]))super(e[0]);else{const t=e[0]||{},r=new Cr;for(const e of t.dns||[])r.push(new Ot({dNSName:e}));for(const e of t.email||[])r.push(new Ot({rfc822Name:e}));for(const e of t.guid||[]){const t=/([0-9a-f]{8})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{12})/i.exec(e);if(!t)throw new Error("Cannot parse GUID value. Value doesn't match to regular expression");const n=t.slice(1).map(((e,t)=>t<3?Xe.ToHex(new Uint8Array(Xe.FromHex(e)).reverse()):e)).join("");r.push(new Ot({otherName:new It({typeId:mi.GUID,value:ht.serialize(new tt(Xe.FromHex(n)))})}))}for(const e of t.ip||[])r.push(new Ot({iPAddress:e}));for(const e of t.url||[])r.push(new Ot({uniformResourceIdentifier:e}));for(const e of t.upn||[])r.push(new Ot({otherName:new It({typeId:mi.UPN,value:ht.serialize(Le.toASN(e))})}));for(const e of t.registeredId||[])r.push(new Ot({registeredID:e}));for(const e of t.otherName||[])r.push(new Ot({otherName:new It({typeId:e.type,value:Xe.FromHex(e.value)})}));super(Ir,e[1],ht.serialize(r))}}onInit(e){super.onInit(e);const t=ht.parse(e.extnValue,Cr);this.dns=t.filter((e=>e.dNSName)).map((e=>e.dNSName||"")),this.email=t.filter((e=>e.rfc822Name)).map((e=>e.rfc822Name||"")),this.ip=t.filter((e=>e.iPAddress)).map((e=>e.iPAddress||"")),this.url=t.filter((e=>e.uniformResourceIdentifier)).map((e=>e.uniformResourceIdentifier||"")),this.upn=t.filter((e=>{var t;return(null===(t=e.otherName)||void 0===t?void 0:t.typeId)===mi.UPN})).map((e=>e.otherName?ht.parse(e.otherName.value,bt).toString():"")),this.guid=t.filter((e=>{var t;return(null===(t=e.otherName)||void 0===t?void 0:t.typeId)===mi.GUID})).map((e=>e.otherName?ht.parse(e.otherName.value,tt):new tt)).map((e=>{const t=/([0-9a-f]{8})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{12})/i.exec(Xe.ToHex(e));if(!t)throw new Error("Cannot parse GUID value. Value doesn't match to regular expression");const r=t.slice(1).map(((e,t)=>t<3?Xe.ToHex(new Uint8Array(Xe.FromHex(e)).reverse()):e)).join("-");return`{${r}}`})),this.registeredId=t.filter((e=>e.registeredID)).map((e=>e.registeredID||"")),this.otherNames=t.filter((e=>e.otherName&&![mi.GUID,mi.UPN].includes(e.otherName.typeId))).map((e=>new vi(e.otherName.typeId,e.otherName.value)))}toJSON(){const e={};return this.dns.length&&(e.dns=[...this.dns]),this.email.length&&(e.email=[...this.email]),this.ip.length&&(e.ip=[...this.ip]),this.guid.length&&(e.guid=[...this.guid]),this.upn.length&&(e.upn=[...this.upn]),this.url.length&&(e.url=[...this.url]),this.registeredId.length&&(e.registeredId=[...this.registeredId]),this.otherNames.length&&(e.otherName=this.otherNames.map((e=>e.toJSON()))),e}}mi.GUID="1.3.6.1.4.1.311.25.1",mi.UPN="1.3.6.1.4.1.311.20.2.3";class bi extends Yr{constructor(...e){var t;if(We.isBufferSource(e[0])){super(e[0]);const t=ht.parse(this.value,Wt);this.policies=t.map((e=>e.policyIdentifier))}else{const r=e[0],n=null!==(t=e[1])&&void 0!==t&&t,i=new Wt(r.map((e=>new Gt({policyIdentifier:e}))));super(Vt,n,ht.serialize(i)),this.policies=r}}}ci.register(Vt,bi);class wi{constructor(e={}){this.attrType="",this.attrValues=[],Object.assign(this,e)}}pt([at({type:ke.ObjectIdentifier})],wi.prototype,"attrType",void 0),pt([at({type:ke.Any,repeated:"set"})],wi.prototype,"attrValues",void 0);class Bi{constructor(e={}){this.acIssuer=new Ot,this.acSerial=0,this.attrs=[],Object.assign(this,e)}}var ki;pt([at({type:Ot})],Bi.prototype,"acIssuer",void 0),pt([at({type:ke.Integer})],Bi.prototype,"acSerial",void 0),pt([at({type:Or,repeated:"sequence"})],Bi.prototype,"attrs",void 0);let Ai=ki=class extends ut{constructor(e){super(e),Object.setPrototypeOf(this,ki.prototype)}};Ai=ki=pt([st({type:Be.Sequence,itemType:ke.ObjectIdentifier})],Ai);class Si{constructor(e={}){this.permitUnSpecified=!0,Object.assign(this,e)}}pt([at({type:ke.Integer,optional:!0})],Si.prototype,"pathLenConstraint",void 0),pt([at({type:Ai,implicit:!0,context:0,optional:!0})],Si.prototype,"permittedAttrs",void 0),pt([at({type:Ai,implicit:!0,context:1,optional:!0})],Si.prototype,"excludedAttrs",void 0),pt([at({type:ke.Boolean,defaultValue:!0})],Si.prototype,"permitUnSpecified",void 0);class xi{constructor(e={}){this.issuer=new Dt,this.serial=new ArrayBuffer(0),this.issuerUID=new ArrayBuffer(0),Object.assign(this,e)}}var Ii;pt([at({type:Dt})],xi.prototype,"issuer",void 0),pt([at({type:ke.Integer,converter:Ce})],xi.prototype,"serial",void 0),pt([at({type:ke.BitString,optional:!0})],xi.prototype,"issuerUID",void 0),function(e){e[e.publicKey=0]="publicKey",e[e.publicKeyCert=1]="publicKeyCert",e[e.otherObjectTypes=2]="otherObjectTypes"}(Ii||(Ii={}));class Ci{constructor(e={}){this.digestedObjectType=Ii.publicKey,this.digestAlgorithm=new Pr,this.objectDigest=new ArrayBuffer(0),Object.assign(this,e)}}pt([at({type:ke.Enumerated})],Ci.prototype,"digestedObjectType",void 0),pt([at({type:ke.ObjectIdentifier,optional:!0})],Ci.prototype,"otherObjectTypeID",void 0),pt([at({type:Pr})],Ci.prototype,"digestAlgorithm",void 0),pt([at({type:ke.BitString})],Ci.prototype,"objectDigest",void 0);class Oi{constructor(e={}){Object.assign(this,e)}}pt([at({type:Dt,optional:!0})],Oi.prototype,"issuerName",void 0),pt([at({type:xi,context:0,implicit:!0,optional:!0})],Oi.prototype,"baseCertificateID",void 0),pt([at({type:Ci,context:1,implicit:!0,optional:!0})],Oi.prototype,"objectDigestInfo",void 0);let Ni=class{constructor(e={}){Object.assign(this,e)}};pt([at({type:Ot,repeated:"sequence"})],Ni.prototype,"v1Form",void 0),pt([at({type:Oi,context:0,implicit:!0})],Ni.prototype,"v2Form",void 0),Ni=pt([st({type:Be.Choice})],Ni);class Ei{constructor(e={}){this.notBeforeTime=new Date,this.notAfterTime=new Date,Object.assign(this,e)}}pt([at({type:ke.GeneralizedTime})],Ei.prototype,"notBeforeTime",void 0),pt([at({type:ke.GeneralizedTime})],Ei.prototype,"notAfterTime",void 0);class Ti{constructor(e={}){Object.assign(this,e)}}var Ui,Li,ji;pt([at({type:xi,implicit:!0,context:0,optional:!0})],Ti.prototype,"baseCertificateID",void 0),pt([at({type:Dt,implicit:!0,context:1,optional:!0})],Ti.prototype,"entityName",void 0),pt([at({type:Ci,implicit:!0,context:2,optional:!0})],Ti.prototype,"objectDigestInfo",void 0),function(e){e[e.v2=1]="v2"}(Ui||(Ui={}));class Hi{constructor(e={}){this.version=Ui.v2,this.holder=new Ti,this.issuer=new Ni,this.signature=new Pr,this.serialNumber=new ArrayBuffer(0),this.attrCertValidityPeriod=new Ei,this.attributes=[],Object.assign(this,e)}}pt([at({type:ke.Integer})],Hi.prototype,"version",void 0),pt([at({type:Ti})],Hi.prototype,"holder",void 0),pt([at({type:Ni})],Hi.prototype,"issuer",void 0),pt([at({type:Pr})],Hi.prototype,"signature",void 0),pt([at({type:ke.Integer,converter:Ce})],Hi.prototype,"serialNumber",void 0),pt([at({type:Ei})],Hi.prototype,"attrCertValidityPeriod",void 0),pt([at({type:Or,repeated:"sequence"})],Hi.prototype,"attributes",void 0),pt([at({type:ke.BitString,optional:!0})],Hi.prototype,"issuerUniqueID",void 0),pt([at({type:zr,optional:!0})],Hi.prototype,"extensions",void 0);class Ri{constructor(e={}){this.acinfo=new Hi,this.signatureAlgorithm=new Pr,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}}pt([at({type:Hi})],Ri.prototype,"acinfo",void 0),pt([at({type:Pr})],Ri.prototype,"signatureAlgorithm",void 0),pt([at({type:ke.BitString})],Ri.prototype,"signatureValue",void 0),function(e){e[e.unmarked=1]="unmarked",e[e.unclassified=2]="unclassified",e[e.restricted=4]="restricted",e[e.confidential=8]="confidential",e[e.secret=16]="secret",e[e.topSecret=32]="topSecret"}(Li||(Li={}));class Pi extends et{}class Di{constructor(e={}){this.type="",this.value=new ArrayBuffer(0),Object.assign(this,e)}}pt([at({type:ke.ObjectIdentifier,implicit:!0,context:0})],Di.prototype,"type",void 0),pt([at({type:ke.Any,implicit:!0,context:1})],Di.prototype,"value",void 0);class _i{constructor(e={}){this.policyId="",this.classList=new Pi(Li.unclassified),Object.assign(this,e)}}pt([at({type:ke.ObjectIdentifier})],_i.prototype,"policyId",void 0),pt([at({type:Pi,defaultValue:new Pi(Li.unclassified)})],_i.prototype,"classList",void 0),pt([at({type:Di,repeated:"set"})],_i.prototype,"securityCategories",void 0);class $i{constructor(e={}){Object.assign(this,e)}}pt([at({type:tt})],$i.prototype,"cotets",void 0),pt([at({type:ke.ObjectIdentifier})],$i.prototype,"oid",void 0),pt([at({type:ke.Utf8String})],$i.prototype,"string",void 0);class Fi{constructor(e={}){this.values=[],Object.assign(this,e)}}pt([at({type:Dt,implicit:!0,context:0,optional:!0})],Fi.prototype,"policyAuthority",void 0),pt([at({type:$i,repeated:"sequence"})],Fi.prototype,"values",void 0);class Vi{constructor(e={}){this.targetCertificate=new xi,Object.assign(this,e)}}pt([at({type:xi})],Vi.prototype,"targetCertificate",void 0),pt([at({type:Ot,optional:!0})],Vi.prototype,"targetName",void 0),pt([at({type:Ci,optional:!0})],Vi.prototype,"certDigestInfo",void 0);let zi=class{constructor(e={}){Object.assign(this,e)}};pt([at({type:Ot,context:0,implicit:!0})],zi.prototype,"targetName",void 0),pt([at({type:Ot,context:1,implicit:!0})],zi.prototype,"targetGroup",void 0),pt([at({type:Vi,context:2,implicit:!0})],zi.prototype,"targetCert",void 0),zi=pt([st({type:Be.Choice})],zi);let Ki=ji=class extends ut{constructor(e){super(e),Object.setPrototypeOf(this,ji.prototype)}};var Mi;Ki=ji=pt([st({type:Be.Sequence,itemType:zi})],Ki);let qi=Mi=class extends ut{constructor(e){super(e),Object.setPrototypeOf(this,Mi.prototype)}};qi=Mi=pt([st({type:Be.Sequence,itemType:Ki})],qi);class Ji{constructor(e={}){Object.assign(this,e)}}pt([at({type:Dt,implicit:!0,context:0,optional:!0})],Ji.prototype,"roleAuthority",void 0),pt([at({type:Ot,implicit:!0,context:1})],Ji.prototype,"roleName",void 0);class Gi{constructor(e={}){this.service=new Ot,this.ident=new Ot,Object.assign(this,e)}}var Wi;pt([at({type:Ot})],Gi.prototype,"service",void 0),pt([at({type:Ot})],Gi.prototype,"ident",void 0),pt([at({type:tt,optional:!0})],Gi.prototype,"authInfo",void 0);class Zi{constructor(e={}){this.otherCertFormat="",this.otherCert=new ArrayBuffer(0),Object.assign(this,e)}}pt([at({type:ke.ObjectIdentifier})],Zi.prototype,"otherCertFormat",void 0),pt([at({type:ke.Any})],Zi.prototype,"otherCert",void 0);let Yi=class{constructor(e={}){Object.assign(this,e)}};pt([at({type:qr})],Yi.prototype,"certificate",void 0),pt([at({type:Ri,context:2,implicit:!0})],Yi.prototype,"v2AttrCert",void 0),pt([at({type:Zi,context:3,implicit:!0})],Yi.prototype,"other",void 0),Yi=pt([st({type:Be.Choice})],Yi);let Xi=Wi=class extends ut{constructor(e){super(e),Object.setPrototypeOf(this,Wi.prototype)}};Xi=Wi=pt([st({type:Be.Set,itemType:Yi})],Xi);class Qi{constructor(e={}){this.contentType="",this.content=new ArrayBuffer(0),Object.assign(this,e)}}pt([at({type:ke.ObjectIdentifier})],Qi.prototype,"contentType",void 0),pt([at({type:ke.Any,context:0})],Qi.prototype,"content",void 0);let eo=class{constructor(e={}){Object.assign(this,e)}};pt([at({type:tt})],eo.prototype,"single",void 0),pt([at({type:ke.Any})],eo.prototype,"any",void 0),eo=pt([st({type:Be.Choice})],eo);class to{constructor(e={}){this.eContentType="",Object.assign(this,e)}}pt([at({type:ke.ObjectIdentifier})],to.prototype,"eContentType",void 0),pt([at({type:eo,context:0,optional:!0})],to.prototype,"eContent",void 0);class ro{constructor(e={}){this.issuer=new St,this.serialNumber=new ArrayBuffer(0),Object.assign(this,e)}}pt([at({type:St})],ro.prototype,"issuer",void 0),pt([at({type:ke.Integer,converter:Ce})],ro.prototype,"serialNumber",void 0);const no="1.2.840.113549.1.7.2";var io;class oo{constructor(e={}){this.otherRevInfoFormat="",this.otherRevInfo=new ArrayBuffer(0),Object.assign(this,e)}}pt([at({type:ke.ObjectIdentifier})],oo.prototype,"otherRevInfoFormat",void 0),pt([at({type:ke.Any})],oo.prototype,"otherRevInfo",void 0);let so=class{constructor(e={}){this.other=new oo,Object.assign(this,e)}};pt([at({type:oo,context:1,implicit:!0})],so.prototype,"other",void 0),so=pt([st({type:Be.Choice})],so);let ao=io=class extends ut{constructor(e){super(e),Object.setPrototypeOf(this,io.prototype)}};var co;ao=io=pt([st({type:Be.Set,itemType:so})],ao),function(e){e[e.v0=0]="v0",e[e.v1=1]="v1",e[e.v2=2]="v2",e[e.v3=3]="v3",e[e.v4=4]="v4",e[e.v5=5]="v5"}(co||(co={}));let lo=class extends Pr{};lo=pt([st({type:Be.Sequence})],lo);let uo=class extends Pr{};uo=pt([st({type:Be.Sequence})],uo);let ho=class{constructor(e={}){Object.assign(this,e)}};var po;pt([at({type:Ur,context:0,implicit:!0})],ho.prototype,"subjectKeyIdentifier",void 0),pt([at({type:ro})],ho.prototype,"issuerAndSerialNumber",void 0),ho=pt([st({type:Be.Choice})],ho);class fo{constructor(e={}){this.version=co.v0,this.sid=new ho,this.digestAlgorithm=new lo,this.signatureAlgorithm=new uo,this.signature=new tt,Object.assign(this,e)}}pt([at({type:ke.Integer})],fo.prototype,"version",void 0),pt([at({type:ho})],fo.prototype,"sid",void 0),pt([at({type:lo})],fo.prototype,"digestAlgorithm",void 0),pt([at({type:wi,repeated:"set",context:0,implicit:!0,optional:!0})],fo.prototype,"signedAttrs",void 0),pt([at({type:uo})],fo.prototype,"signatureAlgorithm",void 0),pt([at({type:tt})],fo.prototype,"signature",void 0),pt([at({type:wi,repeated:"set",context:1,implicit:!0,optional:!0})],fo.prototype,"unsignedAttrs",void 0);let yo=po=class extends ut{constructor(e){super(e),Object.setPrototypeOf(this,po.prototype)}};var go;yo=po=pt([st({type:Be.Set,itemType:fo})],yo);let vo=go=class extends ut{constructor(e){super(e),Object.setPrototypeOf(this,go.prototype)}};vo=go=pt([st({type:Be.Set,itemType:lo})],vo);class mo{constructor(e={}){this.version=co.v0,this.digestAlgorithms=new vo,this.encapContentInfo=new to,this.signerInfos=new yo,Object.assign(this,e)}}var bo;pt([at({type:ke.Integer})],mo.prototype,"version",void 0),pt([at({type:vo})],mo.prototype,"digestAlgorithms",void 0),pt([at({type:to})],mo.prototype,"encapContentInfo",void 0),pt([at({type:Xi,context:0,implicit:!0,optional:!0})],mo.prototype,"certificates",void 0),pt([at({type:so,context:1,implicit:!0,optional:!0})],mo.prototype,"crls",void 0),pt([at({type:yo})],mo.prototype,"signerInfos",void 0);class wo{constructor(e={}){this.attrId="",this.attrValues=[],Object.assign(e)}}pt([at({type:ke.ObjectIdentifier})],wo.prototype,"attrId",void 0),pt([at({type:ke.Any,repeated:"set"})],wo.prototype,"attrValues",void 0);let Bo=bo=class extends ut{constructor(e){super(e),Object.setPrototypeOf(this,bo.prototype)}};var ko;Bo=bo=pt([st({type:Be.Sequence,itemType:wo})],Bo);let Ao=ko=class extends ut{constructor(e){super(e),Object.setPrototypeOf(this,ko.prototype)}};Ao=ko=pt([st({type:Be.Sequence,itemType:Qi})],Ao);class So{constructor(e={}){this.certId="",this.certValue=new ArrayBuffer(0),Object.assign(this,e)}}pt([at({type:ke.ObjectIdentifier})],So.prototype,"certId",void 0),pt([at({type:ke.Any,context:0})],So.prototype,"certValue",void 0);class xo{constructor(e={}){this.crlId="",this.crltValue=new ArrayBuffer(0),Object.assign(this,e)}}pt([at({type:ke.ObjectIdentifier})],xo.prototype,"crlId",void 0),pt([at({type:ke.Any,context:0})],xo.prototype,"crltValue",void 0);class Io extends tt{}class Co{constructor(e={}){this.encryptionAlgorithm=new Pr,this.encryptedData=new Io,Object.assign(this,e)}}var Oo,No;pt([at({type:Pr})],Co.prototype,"encryptionAlgorithm",void 0),pt([at({type:Io})],Co.prototype,"encryptedData",void 0),function(e){e[e.v1=0]="v1"}(No||(No={}));class Eo extends tt{}let To=Oo=class extends ut{constructor(e){super(e),Object.setPrototypeOf(this,Oo.prototype)}};To=Oo=pt([st({type:Be.Sequence,itemType:Or})],To);class Uo{constructor(e={}){this.version=No.v1,this.privateKeyAlgorithm=new Pr,this.privateKey=new Eo,Object.assign(this,e)}}pt([at({type:ke.Integer})],Uo.prototype,"version",void 0),pt([at({type:Pr})],Uo.prototype,"privateKeyAlgorithm",void 0),pt([at({type:Eo})],Uo.prototype,"privateKey",void 0),pt([at({type:To,implicit:!0,context:0,optional:!0})],Uo.prototype,"attributes",void 0);let Lo=class extends Uo{};Lo=pt([st({type:Be.Sequence})],Lo);let jo=class extends Co{};jo=pt([st({type:Be.Sequence})],jo);class Ho{constructor(e={}){this.secretTypeId="",this.secretValue=new ArrayBuffer(0),Object.assign(this,e)}}pt([at({type:ke.ObjectIdentifier})],Ho.prototype,"secretTypeId",void 0),pt([at({type:ke.Any,context:0})],Ho.prototype,"secretValue",void 0);class Ro{constructor(e={}){this.mac=new Bn,this.macSalt=new tt,this.iterations=1,Object.assign(this,e)}}pt([at({type:Bn})],Ro.prototype,"mac",void 0),pt([at({type:tt})],Ro.prototype,"macSalt",void 0),pt([at({type:ke.Integer,defaultValue:1})],Ro.prototype,"iterations",void 0);class Po{constructor(e={}){this.version=3,this.authSafe=new Qi,this.macData=new Ro,Object.assign(this,e)}}var Do;pt([at({type:ke.Integer})],Po.prototype,"version",void 0),pt([at({type:Qi})],Po.prototype,"authSafe",void 0),pt([at({type:Ro,optional:!0})],Po.prototype,"macData",void 0);class _o{constructor(e={}){this.bagId="",this.bagValue=new ArrayBuffer(0),Object.assign(this,e)}}pt([at({type:ke.ObjectIdentifier})],_o.prototype,"bagId",void 0),pt([at({type:ke.Any,context:0})],_o.prototype,"bagValue",void 0),pt([at({type:wo,repeated:"set",optional:!0})],_o.prototype,"bagAttributes",void 0);let $o=Do=class extends ut{constructor(e){super(e),Object.setPrototypeOf(this,Do.prototype)}};var Fo,Vo,zo;$o=Do=pt([st({type:Be.Sequence,itemType:_o})],$o);const Ko="1.2.840.113549.1.9",Mo=`${Ko}.7`,qo=`${Ko}.14`;let Jo=class extends bt{constructor(e={}){super(e)}toString(){return this.ia5String||super.toString()}};pt([at({type:ke.IA5String})],Jo.prototype,"ia5String",void 0),Jo=pt([st({type:Be.Choice})],Jo);let Go=class extends Qi{};Go=pt([st({type:Be.Sequence})],Go);let Wo=class extends Po{};Wo=pt([st({type:Be.Sequence})],Wo);let Zo=class extends Co{};Zo=pt([st({type:Be.Sequence})],Zo);let Yo=class{constructor(e=""){this.value=e}toString(){return this.value}};pt([at({type:ke.IA5String})],Yo.prototype,"value",void 0),Yo=pt([st({type:Be.Choice})],Yo);let Xo=class extends Jo{};Xo=pt([st({type:Be.Choice})],Xo);let Qo=class extends bt{};Qo=pt([st({type:Be.Choice})],Qo);let es=class{constructor(e=new Date){this.value=e}};pt([at({type:ke.GeneralizedTime})],es.prototype,"value",void 0),es=pt([st({type:Be.Choice})],es);let ts=class extends bt{};ts=pt([st({type:Be.Choice})],ts);let rs=class{constructor(e="M"){this.value=e}toString(){return this.value}};pt([at({type:ke.PrintableString})],rs.prototype,"value",void 0),rs=pt([st({type:Be.Choice})],rs);let ns=class{constructor(e=""){this.value=e}toString(){return this.value}};pt([at({type:ke.PrintableString})],ns.prototype,"value",void 0),ns=pt([st({type:Be.Choice})],ns);let is=class extends ns{};is=pt([st({type:Be.Choice})],is);let os=class extends bt{};os=pt([st({type:Be.Choice})],os);let ss=class{constructor(e=""){this.value=e}toString(){return this.value}};pt([at({type:ke.ObjectIdentifier})],ss.prototype,"value",void 0),ss=pt([st({type:Be.Choice})],ss);let as=class extends _r{};as=pt([st({type:Be.Choice})],as);let cs=class{constructor(e=0){this.value=e}toString(){return this.value.toString()}};pt([at({type:ke.Integer})],cs.prototype,"value",void 0),cs=pt([st({type:Be.Choice})],cs);let ls=class extends fo{};ls=pt([st({type:Be.Sequence})],ls);let us=class extends bt{};us=pt([st({type:Be.Choice})],us);let hs=Fo=class extends zr{constructor(e){super(e),Object.setPrototypeOf(this,Fo.prototype)}};hs=Fo=pt([st({type:Be.Sequence})],hs);let ps=Vo=class extends ut{constructor(e){super(e),Object.setPrototypeOf(this,Vo.prototype)}};ps=Vo=pt([st({type:Be.Set,itemType:wi})],ps);let fs=class{constructor(e=""){this.value=e}toString(){return this.value}};pt([at({type:ke.BmpString})],fs.prototype,"value",void 0),fs=pt([st({type:Be.Choice})],fs);let ys=class extends Pr{};ys=pt([st({type:Be.Sequence})],ys);let ds=zo=class extends ut{constructor(e){super(e),Object.setPrototypeOf(this,zo.prototype)}};ds=zo=pt([st({type:Be.Sequence,itemType:ys})],ds);class gs extends Zr{constructor(...e){let t;if(We.isBufferSource(e[0]))t=We.toArrayBuffer(e[0]);else{const r=e[0],n=Array.isArray(e[1])?e[1].map((e=>We.toArrayBuffer(e))):[];t=ht.serialize(new Or({type:r,values:n}))}super(t,Or)}onInit(e){this.type=e.type,this.values=e.values}}class vs extends gs{constructor(...e){var t;if(We.isBufferSource(e[0]))super(e[0]);else{const t=new us({printableString:e[0]});super(Mo,[ht.serialize(t)])}null!==(t=this.password)&&void 0!==t||(this.password="")}onInit(e){if(super.onInit(e),this.values[0]){const e=ht.parse(this.values[0],us);this.password=e.toString()}}}class ms extends gs{constructor(...e){var t;if(We.isBufferSource(e[0]))super(e[0]);else{const t=new zr(e[0]);super(qo,[ht.serialize(t)])}null!==(t=this.items)&&void 0!==t||(this.items=[])}onInit(e){if(super.onInit(e),this.values[0]){const e=ht.parse(this.values[0],zr);this.items=e.map((e=>ci.create(ht.serialize(e))))}}}class bs{static register(e,t){this.items.set(e,t)}static create(e){const t=new gs(e),r=this.items.get(t.type);return r?new r(e):t}}bs.items=new Map,e.RsaAlgorithm=class{toAsnAlgorithm(e){if("rsassa-pkcs1-v1_5"===e.name.toLowerCase()){if(!e.hash)return new Pr({algorithm:tn,parameters:null});switch(e.hash.name.toLowerCase()){case"sha-1":return new Pr({algorithm:cn,parameters:null});case"sha-256":return new Pr({algorithm:ln,parameters:null});case"sha-384":return new Pr({algorithm:un,parameters:null});case"sha-512":return new Pr({algorithm:hn,parameters:null})}}return null}toWebAlgorithm(e){switch(e.algorithm){case tn:return{name:"RSASSA-PKCS1-v1_5"};case cn:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case ln:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case un:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case hn:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}}}return null}},e.RsaAlgorithm=pt([Yn()],e.RsaAlgorithm),Zn.registerSingleton(Xn,e.RsaAlgorithm);const ws="1.2.840.10045.2.1",Bs="1.2.840.10045.4.1",ks="1.2.840.10045.4.3.2",As="1.2.840.10045.4.3.3",Ss="1.2.840.10045.4.3.4",xs="1.2.840.10045.3.1.7",Is="1.3.132.0.34",Cs="1.3.132.0.35";function Os(e){return new Pr({algorithm:e})}const Ns=Os(Bs);Os("1.2.840.10045.4.3.1");const Es=Os(ks),Ts=Os(As),Us=Os(Ss);let Ls=class{constructor(e={}){Object.assign(this,e)}};pt([at({type:ke.ObjectIdentifier})],Ls.prototype,"namedCurve",void 0),Ls=pt([st({type:Be.Choice})],Ls);class js{constructor(e={}){this.version=1,this.privateKey=new tt,Object.assign(this,e)}}pt([at({type:ke.Integer})],js.prototype,"version",void 0),pt([at({type:tt})],js.prototype,"privateKey",void 0),pt([at({type:Ls,context:0,optional:!0})],js.prototype,"parameters",void 0),pt([at({type:ke.BitString,context:1,optional:!0})],js.prototype,"publicKey",void 0);class Hs{constructor(e={}){this.r=new ArrayBuffer(0),this.s=new ArrayBuffer(0),Object.assign(this,e)}}var Rs;pt([at({type:ke.Integer,converter:Ce})],Hs.prototype,"r",void 0),pt([at({type:ke.Integer,converter:Ce})],Hs.prototype,"s",void 0);const Ps="1.3.36.3.3.2.8.1.1",Ds=`${Ps}.1`,_s=`${Ps}.2`,$s=`${Ps}.3`,Fs=`${Ps}.4`,Vs=`${Ps}.5`,zs=`${Ps}.6`,Ks=`${Ps}.7`,Ms=`${Ps}.8`,qs=`${Ps}.9`,Js=`${Ps}.10`,Gs=`${Ps}.11`,Ws=`${Ps}.12`,Zs=`${Ps}.13`,Ys=`${Ps}.14`,Xs="brainpoolP160r1",Qs="brainpoolP160t1",ea="brainpoolP192r1",ta="brainpoolP192t1",ra="brainpoolP224r1",na="brainpoolP224t1",ia="brainpoolP256r1",oa="brainpoolP256t1",sa="brainpoolP320r1",aa="brainpoolP320t1",ca="brainpoolP384r1",la="brainpoolP384t1",ua="brainpoolP512r1",ha="brainpoolP512t1",pa="ECDSA";e.EcAlgorithm=Rs=class{toAsnAlgorithm(e){if(e.name.toLowerCase()===pa.toLowerCase())if("hash"in e){switch(("string"==typeof e.hash?e.hash:e.hash.name).toLowerCase()){case"sha-1":return Ns;case"sha-256":return Es;case"sha-384":return Ts;case"sha-512":return Us}}else if("namedCurve"in e){let t="";switch(e.namedCurve){case"P-256":t=xs;break;case"K-256":t=Rs.SECP256K1;break;case"P-384":t=Is;break;case"P-521":t=Cs;break;case Xs:t=Ds;break;case Qs:t=_s;break;case ea:t=$s;break;case ta:t=Fs;break;case ra:t=Vs;break;case na:t=zs;break;case ia:t=Ks;break;case oa:t=Ms;break;case sa:t=qs;break;case aa:t=Js;break;case ca:t=Gs;break;case la:t=Ws;break;case ua:t=Zs;break;case ha:t=Ys}if(t)return new Pr({algorithm:ws,parameters:ht.serialize(new Ls({namedCurve:t}))})}return null}toWebAlgorithm(e){switch(e.algorithm){case Bs:return{name:pa,hash:{name:"SHA-1"}};case ks:return{name:pa,hash:{name:"SHA-256"}};case As:return{name:pa,hash:{name:"SHA-384"}};case Ss:return{name:pa,hash:{name:"SHA-512"}};case ws:if(!e.parameters)throw new TypeError("Cannot get required parameters from EC algorithm");switch(ht.parse(e.parameters,Ls).namedCurve){case xs:return{name:pa,namedCurve:"P-256"};case Rs.SECP256K1:return{name:pa,namedCurve:"K-256"};case Is:return{name:pa,namedCurve:"P-384"};case Cs:return{name:pa,namedCurve:"P-521"};case Ds:return{name:pa,namedCurve:Xs};case _s:return{name:pa,namedCurve:Qs};case $s:return{name:pa,namedCurve:ea};case Fs:return{name:pa,namedCurve:ta};case Vs:return{name:pa,namedCurve:ra};case zs:return{name:pa,namedCurve:na};case Ks:return{name:pa,namedCurve:ia};case Ms:return{name:pa,namedCurve:oa};case qs:return{name:pa,namedCurve:sa};case Js:return{name:pa,namedCurve:aa};case Gs:return{name:pa,namedCurve:ca};case Ws:return{name:pa,namedCurve:la};case Zs:return{name:pa,namedCurve:ua};case Ys:return{name:pa,namedCurve:ha}}}return null}},e.EcAlgorithm.SECP256K1="1.3.132.0.10",e.EcAlgorithm=Rs=pt([Yn()],e.EcAlgorithm),Zn.registerSingleton(Xn,e.EcAlgorithm);class fa{addPadding(e,t){const r=We.toUint8Array(t),n=new Uint8Array(e);return n.set(r,e-r.length),n}removePadding(e,t=!1){let r=We.toUint8Array(e);for(let e=0;e<r.length;e++)if(r[e]){r=r.slice(e);break}if(t&&r[0]>127){const e=new Uint8Array(r.length+1);return e.set(r,1),e.buffer}return r.buffer}toAsnSignature(e,t){if("ECDSA"===e.name){const r=e.namedCurve,n=fa.namedCurveSize.get(r)||fa.defaultNamedCurveSize,i=new Hs,o=We.toUint8Array(t);return i.r=this.removePadding(o.slice(0,n),!0),i.s=this.removePadding(o.slice(n,n+n),!0),ht.serialize(i)}return null}toWebSignature(e,t){if("ECDSA"===e.name){const r=ht.parse(t,Hs),n=e.namedCurve,i=fa.namedCurveSize.get(n)||fa.defaultNamedCurveSize;return function(...e){const t=e.map((e=>e.byteLength)).reduce(((e,t)=>e+t)),r=new Uint8Array(t);let n=0;return e.map((e=>new Uint8Array(e))).forEach((e=>{for(const t of e)r[n++]=t})),r.buffer}(this.addPadding(i,this.removePadding(r.r)),this.addPadding(i,this.removePadding(r.s)))}return null}}fa.namedCurveSize=new Map,fa.defaultNamedCurveSize=32;const ya="1.3.101.110",da="1.3.101.111",ga="1.3.101.112",va="1.3.101.113";var ma;e.EdAlgorithm=class{toAsnAlgorithm(e){let t=null;switch(e.name.toLowerCase()){case"eddsa":switch(e.namedCurve.toLowerCase()){case"ed25519":t=ga;break;case"ed448":t=va}break;case"ecdh-es":switch(e.namedCurve.toLowerCase()){case"x25519":t=ya;break;case"x448":t=da}}return t?new Pr({algorithm:t}):null}toWebAlgorithm(e){switch(e.algorithm){case ga:return{name:"EdDSA",namedCurve:"Ed25519"};case va:return{name:"EdDSA",namedCurve:"Ed448"};case ya:return{name:"ECDH-ES",namedCurve:"X25519"};case da:return{name:"ECDH-ES",namedCurve:"X448"}}return null}},e.EdAlgorithm=pt([Yn()],e.EdAlgorithm),Zn.registerSingleton(Xn,e.EdAlgorithm);let ba=ma=class extends ut{constructor(e){super(e),Object.setPrototypeOf(this,ma.prototype)}};ba=ma=pt([st({type:Be.Sequence,itemType:Or})],ba);class wa{constructor(e={}){this.version=0,this.subject=new St,this.subjectPKInfo=new Dr,this.attributes=new ba,Object.assign(this,e)}}pt([at({type:ke.Integer})],wa.prototype,"version",void 0),pt([at({type:St})],wa.prototype,"subject",void 0),pt([at({type:Dr})],wa.prototype,"subjectPKInfo",void 0),pt([at({type:ba,implicit:!0,context:0})],wa.prototype,"attributes",void 0);class Ba{constructor(e={}){this.certificationRequestInfo=new wa,this.signatureAlgorithm=new Pr,this.signature=new ArrayBuffer(0),Object.assign(this,e)}}pt([at({type:wa})],Ba.prototype,"certificationRequestInfo",void 0),pt([at({type:Pr})],Ba.prototype,"signatureAlgorithm",void 0),pt([at({type:ke.BitString})],Ba.prototype,"signature",void 0);class ka extends ri{constructor(e){ri.isAsnEncoded(e)?super(e,Ba):super(e),this.tag="CERTIFICATE REQUEST"}onInit(e){this.tbs=ht.serialize(e.certificationRequestInfo),this.publicKey=new ni(e.certificationRequestInfo.subjectPKInfo);const t=Zn.resolve(ei);this.signatureAlgorithm=t.toWebAlgorithm(e.signatureAlgorithm),this.signature=e.signature,this.attributes=e.certificationRequestInfo.attributes.map((e=>bs.create(ht.serialize(e))));const r=this.getAttribute(qo);this.extensions=[],r instanceof ms&&(this.extensions=r.items),this.subjectName=new ai(e.certificationRequestInfo.subject),this.subject=this.subjectName.toString()}getAttribute(e){for(const t of this.attributes)if(t.type===e)return t;return null}getAttributes(e){return this.attributes.filter((t=>t.type===e))}getExtension(e){for(const t of this.extensions)if(t.type===e)return t;return null}getExtensions(e){return this.extensions.filter((t=>t.type===e))}async verify(e=Qr.get()){const t={...this.publicKey.algorithm,...this.signatureAlgorithm},r=await this.publicKey.export(t,["verify"],e),n=Zn.resolveAll(li).reverse();let i=null;for(const e of n)if(i=e.toWebSignature(t,this.signature),i)break;if(!i)throw Error("Cannot convert WebCrypto signature value to ASN.1 format");return await e.subtle.verify(this.signatureAlgorithm,r,i,this.tbs)}}class Aa extends Array{constructor(e){if(super(),ri.isAsnEncoded(e))this.import(e);else if(e instanceof hi)this.push(e);else if(Array.isArray(e))for(const t of e)this.push(t)}export(e){const t=new mo;t.certificates=new Xi(this.map((e=>new Yi({certificate:ht.parse(e.rawData,qr)}))));const r=new Qi({contentType:no,content:ht.serialize(t)}),n=ht.serialize(r);return"raw"===e?n:this.toString(e)}import(e){const t=ri.toArrayBuffer(e),r=ht.parse(t,Qi);if(r.contentType!==no)throw new TypeError("Cannot parse CMS package. Incoming data is not a SignedData object.");const n=ht.parse(r.content,mo);this.clear();for(const e of n.certificates||[])e.certificate&&this.push(new hi(e.certificate))}clear(){for(;this.pop(););}toString(e="pem"){const t=this.export("raw");switch(e){case"pem":return ti.encode(t,"CMS");case"hex":return Xe.ToHex(t);case"base64":return Xe.ToBase64(t);case"base64url":return Xe.ToBase64Url(t);default:throw TypeError("Argument 'format' is unsupported value")}}}return ci.register(Ht,fi),ci.register(ur,yi),ci.register(gr,di),ci.register(Tr,gi),ci.register(Ut,pi),ci.register(Ir,mi),bs.register(Mo,vs),bs.register(qo,ms),Zn.registerSingleton(li,ui),Zn.registerSingleton(li,fa),fa.namedCurveSize.set("P-256",32),fa.namedCurveSize.set("K-256",32),fa.namedCurveSize.set("P-384",48),fa.namedCurveSize.set("P-521",66),e.AlgorithmProvider=Qn,e.AsnData=Zr,e.AsnDefaultSignatureFormatter=ui,e.AsnEcSignatureFormatter=fa,e.Attribute=gs,e.AttributeFactory=bs,e.AuthorityKeyIdentifierExtension=pi,e.BasicConstraintsExtension=fi,e.CertificatePolicyExtension=bi,e.ChallengePasswordAttribute=vs,e.CryptoProvider=Xr,e.ExtendedKeyUsageExtension=yi,e.Extension=Yr,e.ExtensionFactory=ci,e.ExtensionsAttribute=ms,e.KeyUsagesExtension=di,e.Name=ai,e.NameIdentifier=ii,e.OtherName=vi,e.PemConverter=ti,e.Pkcs10CertificateRequest=ka,e.Pkcs10CertificateRequestGenerator=class{static async create(e,t=Qr.get()){if(!e.keys.privateKey)throw new Error("Bad field 'keys' in 'params' argument. 'privateKey' is empty");if(!e.keys.publicKey)throw new Error("Bad field 'keys' in 'params' argument. 'privateKey' is empty");const r=await t.subtle.exportKey("spki",e.keys.publicKey),n=new Ba({certificationRequestInfo:new wa({subjectPKInfo:ht.parse(r,Dr)})});if(e.name){const t=e.name instanceof ai?e.name:new ai(e.name);n.certificationRequestInfo.subject=ht.parse(t.toArrayBuffer(),St)}if(e.attributes)for(const t of e.attributes)n.certificationRequestInfo.attributes.push(ht.parse(t.rawData,Or));if(e.extensions&&e.extensions.length){const t=new Or({type:qo}),r=new zr;for(const t of e.extensions)r.push(ht.parse(t.rawData,Vr));t.values.push(ht.serialize(r)),n.certificationRequestInfo.attributes.push(t)}const i={...e.signingAlgorithm,...e.keys.privateKey.algorithm},o=Zn.resolve(ei);n.signatureAlgorithm=o.toAsnAlgorithm(i);const s=ht.serialize(n.certificationRequestInfo),a=await t.subtle.sign(i,e.keys.privateKey,s),c=Zn.resolveAll(li).reverse();let l=null;for(const e of c)if(l=e.toAsnSignature(i,a),l)break;if(!l)throw Error("Cannot convert WebCrypto signature value to ASN.1 format");return n.signature=l,new ka(ht.serialize(n))}},e.PublicKey=ni,e.SubjectAlternativeNameExtension=mi,e.SubjectKeyIdentifierExtension=gi,e.X509Certificate=hi,e.X509CertificateGenerator=class{static async createSelfSigned(e,t=Qr.get()){if(!e.keys.privateKey)throw new Error("Bad field 'keys' in 'params' argument. 'privateKey' is empty");if(!e.keys.publicKey)throw new Error("Bad field 'keys' in 'params' argument. 'privateKey' is empty");return this.create({serialNumber:e.serialNumber,subject:e.name,issuer:e.name,notBefore:e.notBefore,notAfter:e.notAfter,publicKey:e.keys.publicKey,signingKey:e.keys.privateKey,signingAlgorithm:e.signingAlgorithm,extensions:e.extensions},t)}static async create(e,t=Qr.get()){var r;const n=await t.subtle.exportKey("spki",e.publicKey),i=new qr({tbsCertificate:new Mr({version:Kr.v3,serialNumber:Xe.FromHex(e.serialNumber),validity:new $r({notBefore:e.notBefore,notAfter:e.notAfter}),extensions:new zr((null===(r=e.extensions)||void 0===r?void 0:r.map((e=>ht.parse(e.rawData,Vr))))||[]),subjectPublicKeyInfo:ht.parse(n,Dr)})});if(e.subject){const t=e.subject instanceof ai?e.subject:new ai(e.subject);i.tbsCertificate.subject=ht.parse(t.toArrayBuffer(),St)}if(e.issuer){const t=e.issuer instanceof ai?e.issuer:new ai(e.issuer);i.tbsCertificate.issuer=ht.parse(t.toArrayBuffer(),St)}const o={...e.signingAlgorithm,...e.signingKey.algorithm},s=Zn.resolve(ei);i.tbsCertificate.signature=i.signatureAlgorithm=s.toAsnAlgorithm(o);const a=ht.serialize(i.tbsCertificate),c=await t.subtle.sign(o,e.signingKey,a),l=Zn.resolveAll(li).reverse();let u=null;for(const e of l)if(u=e.toAsnSignature(o,c),u)break;if(!u)throw Error("Cannot convert ASN.1 signature value to WebCrypto format");return i.signatureValue=u,new hi(ht.serialize(i))}},e.X509Certificates=Aa,e.X509ChainBuilder=class{constructor(e={}){this.certificates=[],e.certificates&&(this.certificates=e.certificates)}async build(e){const t=new Aa(e);let r=e;for(;r=await this.findIssuer(r);){const e=await r.getThumbprint();for(const r of t){if(Qe(e,await r.getThumbprint()))throw new Error("Cannot build a certificate chain. Circular dependency.")}t.push(r)}return t}async findIssuer(e){if(!await e.isSelfSigned()){const t=e.getExtension(Ut);for(const r of this.certificates)if(r.subject===e.issuer){if(t)if(t.keyId){const e=r.getExtension(Tr);if(e&&e.keyId!==t.keyId)continue}else if(t.certId){const e=r.getExtension(Ir);if(e&&(t.certId.serialNumber!==r.serialNumber||!Qe(ht.serialize(t.certId.name),ht.serialize(e))))continue}if(await e.verify({publicKey:await r.publicKey.export(),signatureOnly:!0}))return r}}return null}},e.cryptoProvider=Qr,e.diAlgorithm=Xn,e.diAlgorithmProvider=ei,e.diAsnSignatureFormatter=li,e.idEd25519=ga,e.idEd448=va,e.idX25519=ya,e.idX448=da,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
